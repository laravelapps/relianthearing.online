var eiv = '2.0.0'; var exitintelAccount = 291;exitintelBetaStats = true;window.exitintelConfig = window.exitintelConfig || {}
window.exitintelConfig.clientId = 291;
window.exitintelConfig.skipPreloading = false;
window.exitintelConfig.loadEvent = 'load';
exitintelConfig.storageEngine = 'cookie-subdomain';
if (typeof window.exitintelLoaded === 'undefined' || !window.exitintelLoaded) {/*! ei-snippet 18-04-2019 */
!function(a,b){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b),c=c;b>c;c++)if(c in this&&this[c]===a)return c;return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});var c={};try{c.VERSION="0.3.19",a.exitintelConfig=a.exitintelConfig||{},c.config={apiURL:a.exitintelConfig.apiURL||"//app3.exitintel.com/api/v1",cdnURL:a.exitintelConfig.cdnURL||"//cdn2.exitintel.com/api/v1",profilerLibURL:"http://52.6.28.228:3333/socket.io/socket.io.js",profilerURL:"http://52.6.28.228:3333/",integrationsApiUrl:a.exitintelConfig.integrationsApiURL||"https://app3.exitintel.com/integrations",reportURL:a.exitintelConfig.reportURL||"https://oroqbbwxk3.execute-api.us-east-1.amazonaws.com/production/send",compatibleJQueryVersions:"2.1.4 2.1.3 2.1.1 2.1.0 2.0.3 2.0.2 2.0.1 2.0.0 1.11.3 1.11.2 1.11.1 1.11.0 1.10.2 1.10.1 1.10.0 1.9.1 1.9.0 1.8.3 1.8.2 1.8.1 1.8.0 1.7.2 1.7.1 1.7.0".split(" "),cookieExpirationDays:1825,debug:!1,clientId:null,whitelabel:!0,brandingType:"standard",primaryBrandColor:"#333",schemaVersion:1,profilerEnabled:a.exitintelConfig.profilerEnabled||!1,skipPreloading:a.exitintelConfig.skipPreloading||!1,prefetchedConfiguration:a.exitintelConfig.prefetchedConfiguration||!1,storageEngine:a.exitintelConfig.storageEngine||"cookie-domain",audiences:[],disabled:!1},c.util={jQuery:null,detectDevice:{},loadJQuery:function(a){return window.jQei&&window.jQei.fn&&c.util.isJQueryCompatible(window.jQei)?(c.util.jQuery=window.jQei,a(c.util.jQuery),void c.util.log("Using legacy snippet jQuery.")):"undefined"!=typeof window.jQuery&&c.util.isJQueryCompatible(window.jQuery)?(c.util.jQuery=window.jQuery,a(c.util.jQuery),void c.util.log("jQuery already loaded")):(c.util.log("Loading jQuery"),void c.util.loadJS("//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js",function(){c.util.log("jQuery loaded ("+jQuery.fn.jquery+")");var b=jQuery.noConflict(!0);c.util.jQuery=b,a(c.util.jQuery)}))},loadJS:function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,"undefined"!=typeof d.onreadystatechange?d.onreadystatechange=function(){("complete"==d.readyState||"loaded"==d.readyState)&&setTimeout(b,100)}:d.onload=b,c.appendChild(d)},onDOMReady:function(a){if(document.readyState&&-1!==["complete"].indexOf(document.readyState)&&a(),document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(document.attachEvent)document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()});else{var b=window.onload;window.onload=function(){b&&b(),a()}}},loadCSS:function(){},getUniqueId:function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b},log:function(a){c.config.debug&&console.log(a)},warn:function(a){c.config.debug&&console.warn(a)},error:function(a){c.config.debug&&console.error(a)},pageURLIs:function(a){for(var b=a.toLowerCase().split(","),c=0;c<b.length;c++){var d=b[c];if(document.URL.toLowerCase()==d)return!0}return!1},pageURLContains:function(a){for(var b=a.toLowerCase().split(","),c=0;c<b.length;c++){var d=b[c];if(document.URL.toLowerCase().indexOf(d)>-1)return!0}return!1},referrerURLIs:function(a){for(var b=a.toLowerCase().split(","),d=0;d<b.length;d++){var e=b[d];if(c.visitor.session.originalReferrer.toLowerCase()==e)return!0}return!1},referrerURLContains:function(a){for(var b=a.toLowerCase().split(","),d=0;d<b.length;d++){var e=b[d];if(c.visitor.session.originalReferrer.toLowerCase().indexOf(e)>-1)return!0}return!1},landingPageURLIs:function(a){for(var b=a.toLowerCase().split(","),d=0;d<b.length;d++){var e=b[d];if(c.visitor.session.landingPage.toLowerCase()==e)return!0}return!1},landingPageURLContains:function(a){for(var b=a.toLowerCase().split(","),d=0;d<b.length;d++){var e=b[d];if(c.visitor.session.landingPage.toLowerCase().indexOf(e)>-1)return!0}return!1},preloadImage:function(a){var b=new c.util.jQuery.Deferred,d=new Image;return d.onload=function(){b.resolve()},d.src=a,b},getDayOffset:function(a){if(!a)return null;var b=Math.floor((new Date).getTime()/1e3),c=b+3600*a*24;return c},ieVersion:function(){for(var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a},iOSversion:function(){if(/iP(hone|od|ad)/.test(navigator.appVersion)){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}return!1},isPlaceholderSupported:function(){var a="[object OperaMini]"==Object.prototype.toString.call(window.operamini),b="placeholder"in document.createElement("input")&&!a;return b},campaignCookieWithinTimeOffset:function(a,b,c){var d=Math.floor((new Date).getTime()/1e3);return b&&a.timestamp&&a.timestamp+24*b*3600>d?!1:c&&a.timestamp&&a.timestamp+24*c*3600<d?!1:!0},getPublicationId:function(){var a=c.cookie.get("publication");return a?a:null},sizeFormat:function(a){return"string"==typeof a&&(a.match(/px/)||a.match(/%/))?a:a+"px"},isJQueryCompatible:function(a){var b=a.fn.jquery.split("."),d=parseInt(b[0],10),e=parseInt(b[1],10);return d>=2?!0:1==d&&e>10?!0:-1!==c.config.compatibleJQueryVersions.indexOf(a.fn.jquery)},runAnimation:function(a,b,d){var e=!1,f=function(){e||(a.removeClass("animated"),a.removeClass(b),e=!0,g.resolve())},g=c.util.jQuery.Deferred();return a.css({"animation-duration":(d||"1")+"s"}),a.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",f),a.addClass("animated"),a.addClass(b),setTimeout(f,1e3*(d+1)),g.promise()},getGeoLocation:function(){var a=c.util.jQuery.Deferred();try{localStorage.getItem("exitintel_geo")?a.resolve():c.util.jQuery.ajax({url:"https://j576j5dsib.execute-api.us-east-1.amazonaws.com/prod/custom/common/geolocate?callback=?",dataType:"json",timeout:1e4,success:function(b){localStorage.setItem("exitintel_geo",JSON.stringify(b)),a.resolve()},error:function(){c.report.error("timeout","getGeoLocation request reached timeout."),a.reject(),c.ad.visibleAds.popup&&c.ad.visibleAds.popup.hide(),c.ad.visibleAds.persistent&&c.ad.visibleAds.persistent.hide()}})}catch(b){a.resolve()}return a.promise()},getCountry:function(){var a=c.util.jQuery.Deferred();return c.util.jQuery.ajax({url:"https://qlishxpg68.execute-api.us-east-1.amazonaws.com/dev/cf-geo-locate?callback=?",dataType:"json",timeout:1e4,success:function(b){"success"===b.status&&a.resolve(b.country)},error:function(){c.report.error("timeout","getCountry request reached timeout."),a.reject(),c.ad.visibleAds.popup&&c.ad.visibleAds.popup.hide(),c.ad.visibleAds.persistent&&c.ad.visibleAds.persistent.hide()}}),a.promise()},padLeft:function(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a},getContrastingColor:function(a,b){var d,e,f,g,h=a;if(a.match(/gradient/)&&(a=a.match(/gradient\((.*)\)/)[1].match(/rgba\([^\)]+\)/)[0]),a.match(/^rgb/)){var i=a.substring(a.indexOf("(")).split(",");d=parseInt(i[0].replace(/^\s+|\s+$/gm,"").substring(1),10),e=parseInt(i[1].replace(/^\s+|\s+$/gm,""),10),f=parseInt(i[2].replace(/^\s+|\s+$/gm,""),10),g=parseFloat(i[3].replace(/^\s+|\s+$/gm,"").substring(0,i[3].length-1)).toFixed(2),h="#"+d.toString(16)+e.toString(16)+f.toString(16)}if(0===h.indexOf("#")&&(h=h.slice(1)),3===h.length&&(h=h[0]+h[0]+h[1]+h[1]+h[2]+h[2]),6!==h.length)throw new Error("Invalid HEX color.");return d=parseInt(h.slice(0,2),16),e=parseInt(h.slice(2,4),16),f=parseInt(h.slice(4,6),16),b?.299*d+.587*e+.114*f>186?"#000000":"#FFFFFF":(d=(255-d).toString(16),e=(255-e).toString(16),f=(255-f).toString(16),"#"+c.util.padLeft(d,2)+c.util.padLeft(e,2)+c.util.padLeft(f,2))}},function(a){var b=/iPhone/i,c=/iPod/i,d=/iPad/i,e=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,f=/Android/i,g=/IEMobile/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,i=/BlackBerry/i,j=/BB10/i,k=/Opera Mini/i,l=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,m=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),n=function(a,b){return a.test(b)},o=function(a){var o=a||navigator.userAgent;return this.apple={phone:n(b,o),ipod:n(c,o),tablet:n(d,o),device:n(b,o)||n(c,o)||n(d,o)},this.android={phone:n(e,o),tablet:!n(e,o)&&n(f,o),device:n(e,o)||n(f,o)},this.windows={phone:n(g,o),tablet:n(h,o),device:n(g,o)||n(h,o)},this.other={blackberry:n(i,o),blackberry10:n(j,o),opera:n(k,o),firefox:n(l,o),device:n(i,o)||n(j,o)||n(k,o)||n(l,o)},this.seven_inch=n(m,o),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window?this:void 0},p=function(){var a=new o;return a.Class=o,a};a.isMobile=p()}(c.util.detectDevice),c.util.loadJQuery(function(d){if(window.XDomainRequest&&d.ajaxTransport(function(a){if(a.crossDomain&&a.async){a.timeout&&(a.xdrTimeout=a.timeout,delete a.timeout);var c;return{send:function(e,f){function g(a,e,g,h){c.onload=c.onerror=c.ontimeout=d.noop,c=b,f(a,e,g,h)}c=new XDomainRequest,c.onload=function(){g(200,"OK",{text:c.responseText},"Content-Type: "+c.contentType)},c.onerror=function(){g(404,"Not Found")},c.onprogress=d.noop,c.ontimeout=function(){g(0,"timeout")},c.timeout=a.xdrTimeout||Number.MAX_VALUE,c.open(a.type,a.url),c.send(a.hasContent&&a.data||null)},abort:function(){c&&(c.onerror=d.noop,c.abort())}}}}),c.api={getCampaigns:function(a,b){var e="",f="";240===a&&(e="?_t="+Math.floor((new Date).valueOf()/3e5)),f="?_t="+Math.floor((new Date).valueOf());var g=c.config.cdnURL+"/serve/"+a+e;g=c.debug.preview.isPreviewSession?c.config.apiURL+"/preview/"+a+"/"+c.debug.preview.campaignId+"/"+c.debug.preview.adId+f:b?"master-preview"==b?c.config.apiURL+"/serve/"+a+f:c.config.apiURL+"/pub/"+a+"/"+b+f:c.config.cdnURL+"/pub/"+a+e,setTimeout(function(){d.ajax({url:g,jsonp:"callback",jsonpCallback:"exitintel.campaign.campaignsFileLoaded",dataType:"jsonp",cache:!0})})}},c.asset={loadedAssets:{},has:function(a){return this.loadedAssets[a]},load:function(a){var b=c.util.jQuery.Deferred();return this.has(a)?setTimeout(function(){b.resolve()}):(this.loadedAssets[a]=b,c.util.jQuery.ajax({url:c.config.cdnURL+"/file/get/"+a,dataType:"jsonp",jsonp:"callback",jsonpCallback:"exitintel.asset.loaded",cache:!0})),b.promise()},loaded:function(a){c.ad.enableCustomCSS("asset-"+a.filename.split(".").shift(),{customCSS:a.css}),this.loadedAssets[a.filename].resolve()}},c.ad={installedAds:{},adTriggers:{},visibleAds:{popup:null,persistent:null},promises:{},install:function(a,b){var d=new c.util.jQuery.Deferred;return c.util.log("Installing "+a.id),"undefined"!=typeof this.installedAds[a.id]?(c.util.log(a.id+" is already installed"),d.resolve(this.installedAds[a.id]),d):(c.profiler.send("ad-installing:"+a.id),this.makeCommonElements(a),this.preloadImages(a,function(){c.profiler.send("ad-preloaded:"+a.id),c.util.log("Images loaded for "+a.id);var e=c.ad.render(a);e&&(c.ad.installedAds[a.id]=e,a.pageImpressions=0,b&&b.noTriggers||(c.util.log("Installing trigger for "+a.id),c.ad.installTrigger(a,e,{displayLimitPerPage:b.displayLimitPerPage,priority:b.priority})),d.resolve(e))}),d)},makeCommonElements:function(a){for(var b=0;b<a.selectedVersion.template.panels.length;b++)for(var d=0;d<a.selectedVersion.template.panels[b].elements.length;d++)a.selectedVersion.template.panels[b].elements[d].showOnMultipleSteps&&a.selectedVersion.template.panels[b].elements.splice(d,1);if(a.selectedVersion.template.commonElements){c.util.log("Making common elements "+a.id);for(var e=0;e<a.selectedVersion.template.commonElements.length;e++)for(var f=a.selectedVersion.template.commonElements[e],g=0;g<f.visibleOnSteps.length;g++)f.visibleOnSteps[g]===!0&&a.selectedVersion.template.panels[g]&&a.selectedVersion.template.panels[g].elements.push(f)}},preloadImages:function(a,b){var e=[],f=[],g=[],h=[];if(c.config.skipPreloading)return void b();a.selectedVersion.template.overlayBackgroundImage&&e.push(c.config.cdnURL+a.selectedVersion.template.overlayBackgroundImage),a.selectedVersion.template.backgroundImage&&e.push(c.config.cdnURL+a.selectedVersion.template.backgroundImage);for(var i=0;i<a.selectedVersion.template.panels.length;i++){var j=a.selectedVersion.template.panels[i];j.backgroundImage&&e.push(c.config.cdnURL+j.backgroundImage);for(var k=0;k<j.elements.length;k++){if(j.elements[k].backgroundImage&&e.push(c.config.cdnURL+j.elements[k].backgroundImage),j.elements[k].animationEnabled&&j.elements[k].animation.effect){var l=j.elements[k].animation.effect.split(":").pop();-1===g.indexOf(l)&&g.push(l)}j.elements[k].hover&&j.elements[k].hover.enabled&&j.elements[k].hover.effect&&("crossfade"!==j.elements[k].hover.effect&&h.push(j.elements[k].hover.effect),j.elements[k].hover.image&&e.push(c.config.cdnURL+j.elements[k].hover.image))}}for(var m=a.selectedVersion.template.commonElements,n=0;m>n;n++)for(var o=m[n],p=0;p<o.visibleOnSteps.length;p++){if(o.visibleOnSteps[p]&&o.animationEnabled&&o.animation.effect){var q=o.animation.effect.split(":").pop();-1===g.indexOf(q)&&g.push(q)}o.visibleOnSteps[p]&&o.hover&&o.hover.enabled&&o.hover.effect&&("crossfade"!==o.hover.effect&&h.push(o.hover.effect),o.hover.image&&e.push(c.config.cdnURL+o.hover.image))}for(var r=0;r<e.length;r++)f.push(c.util.preloadImage(e[r]));if(this.promises[a.id]={},this.promises[a.id].animations=c.util.jQuery.Deferred(),this.promises[a.id].hoverAnimations=c.util.jQuery.Deferred(),"object"==typeof a.selectedVersion.template.animations&&("object"==typeof a.selectedVersion.template.animations.transition&&"object"==typeof a.selectedVersion.template.animations.transition.effect&&a.selectedVersion.template.animations.transition.effect&&a.selectedVersion.template.animations.transition.effect.animations&&(g.push(a.selectedVersion.template.animations.transition.effect.animations[0]),g.push(a.selectedVersion.template.animations.transition.effect.animations[1])),"object"==typeof a.selectedVersion.template.animations.appearence&&a.selectedVersion.template.animations.appearence.effect&&g.push(a.selectedVersion.template.animations.appearence.effect),"object"==typeof a.selectedVersion.template.animations.closing&&a.selectedVersion.template.animations.closing.effect&&g.push(a.selectedVersion.template.animations.closing.effect),"object"==typeof a.selectedVersion.template.animations.overlayAppearence&&a.selectedVersion.template.animations.overlayAppearence.effect&&g.push(a.selectedVersion.template.animations.overlayAppearence.effect),"object"==typeof a.selectedVersion.template.animations.overlayClosing&&a.selectedVersion.template.animations.overlayClosing.effect&&g.push(a.selectedVersion.template.animations.overlayClosing.effect)),g.length&&(c.util.jQuery.ajax({url:c.config.cdnURL+"/module/animations/?id="+g.join(","),data:{ad:a.id},dataType:"jsonp",jsonp:"callback",jsonpCallback:"exitintel.ad.loadedAnimations",cache:!0}),f.push(this.promises[a.id].animations)),h.length&&(c.util.jQuery.ajax({url:c.config.cdnURL+"/module/hover/?id="+h.join(","),data:{ad:a.id},dataType:"jsonp",jsonp:"callback",jsonpCallback:"exitintel.ad.loadedHoverAnimations",cache:!0}),f.push(this.promises[a.id].hoverAnimations)),a.selectedVersion.template.panels)for(var s=0;s<a.selectedVersion.template.panels.length;s++){var t=a.selectedVersion.template.panels[s];if(t.elements)for(var u=0;u<t.elements.length;u++)if("close-button"===t.elements[u].subtype&&f.push(c.asset.load("close-button.css")),t.elements[u].actions&&t.elements[u].actions.length)for(var v=0;v<t.elements[u].actions.length;v++)"accept-decline-prompt"===t.elements[u].actions[v]["class"]&&f.push(c.asset.load("accept-decline-prompt.css"))}return f.length?void d.when.apply(d,f).then(function(){b()},function(){c.util.log("Images failed to load. Aborting.")}):void b()},loadedAnimations:function(a){var b=this.findAdById(a.ad);b.selectedVersion.template.animationsCss=a.css,this.promises[b.id].animations.resolve()},loadedHoverAnimations:function(a){var b=this.findAdById(a.ad);b.selectedVersion.template.customCSS+="\n"+a.css,this.promises[b.id].hoverAnimations.resolve()},loadedCloseButton:function(a){var b=this.findAdById(a.ad);b.selectedVersion.template.customCSS+="\n"+a.css,this.promises[b.id].closeButton.resolve()},findAdById:function(a){for(var b=null,d=0;d<c.campaign.active.length;d++){var e=c.campaign.active[d];e.selectedAd&&e.selectedAd.id===a&&(b=e.selectedAd)}if(b)return b;for(var f=0;f<c.campaign.available.length;f++){var g=c.campaign.available[f];g.selectedAd&&g.selectedAd.id===a&&(b=g.selectedAd)}return b},installTrigger:function(a,b,d){var e=c.util.detectDevice.isMobile,f="desktop";e.phone?f="phone":e.tablet&&(f="tablet");var g=a.selectedVersion.trigger?a.selectedVersion.trigger[f]:null;c.util.log("Installing trigger for "+f);var h=null,i={"on-load":"onLoad","on-stop-scrolling":"onScrollTimeout","on-scrolled-to-bottom":"onScrolledToBottom","on-scrolled-to-element":"onScrolledToElement","on-exit-intent":"onExit",manual:null};if(g&&g.type&&i[g.type]){if("undefined"==typeof c.ad.adTriggers[g.type]&&(c.ad.adTriggers[g.type]={}),c.ad.adTriggers[g.type].triggerId){if(!(d.priority>c.ad.adTriggers[g.type].priority))return;c.trigger.uninstall(c.ad.adTriggers[g.type].triggerId)}h=c.trigger.install(i[g.type],this.showAdFunction(a,b,d),{delay:g.delay||0,selector:g.selector||null,targetMode:g.targetMode||null,postpone:g.postpone||null,postponeBy:g.postponeBy||0}),c.profiler.send("ad-trigger-installed:"+a.id),c.util.log("Installed trigger: "+g.type+" for "+a.id),a.triggerId=h,c.ad.adTriggers[g.type]={priority:d.priority,triggerId:h}}},showAdFunction:function(a,b,e){var f=null;try{f=c.campaign.available.filter(function(b){return b.id==a.campaignId?!0:!1}).pop()}catch(g){c.util.log("Error: cannot find campaign: "+a.campaignId)}var h=function(g){if("Popup"==a.selectedVersion.template.type&&null!==c.ad.visibleAds.popup)return void c.util.log("Ad of type "+a.selectedVersion.template.type+" already displayed.");if("Persistent"==a.selectedVersion.template.type&&null!==c.ad.visibleAds.persistent)return void c.util.log("Ad of type "+a.selectedVersion.template.type+" already displayed.");if(e.displayLimitPerPage&&e.displayLimitPerPage<=a.pageImpressions)return void c.util.log("Ad "+a.id+" not shown because it reached page impression limit.");var h=[],i=[];"undefined"!=typeof a.selectedVersion.template.JSSnippets&&(i=a.selectedVersion.template.JSSnippets),"undefined"!=typeof a.snippets&&"undefined"!=typeof a.snippets["impression-js"]&&(i=i.concat(a.snippets["impression-js"]));for(var j=0;j<i.length;j++){var k=i[j];-1==k.source.indexOf("deferred.resolve()")&&(k.source+=";\ndeferred.resolve();"),-1==k.source.indexOf("return deferred.promise();")&&(k.source+=";\nreturn deferred.promise();");var l=new Function("deferred","params",k.source),m=new c.util.jQuery.Deferred;h.push(m),l(m,{campaign:f,ad:a,adDisplay:b})}d.when.apply(d,h).then(function(){b.show(),a.pageImpressions++,c.event.log("ad-impression",{campaignId:a.campaignId,adId:a.id}),c.profiler.send("ad-impression:"+a.id);try{c.events.emit("ad-impression",{campaignId:a.campaignId,adId:a.id})}catch(d){c.util.error(d)}if(c.visitor.setSeenCampaign(a.campaignId,{adId:a.id}),a.selectedVersion.template.impressionJS){var e=new Function("thisCampaign","thisAd",a.selectedVersion.template.impressionJS);e(f,a)}a.selectedVersion.template.integrations&&a.selectedVersion.template.integrations.ga&&a.selectedVersion.template.integrations.ga.enabled&&("object"!=typeof a.selectedVersion.template.integrations.ga.onImpression&&(a.selectedVersion.template.integrations.ga.onImpression={}),c.integrations.ga.trackEvent(a.selectedVersion.template.integrations.ga.onImpression.eventCategory||"Exit Intel",a.selectedVersion.template.integrations.ga.onImpression.eventAction||"Impression",a.selectedVersion.template.integrations.ga.onImpression.eventLabel||f.title+" / "+a.title,a.selectedVersion.template.integrations.ga.onImpression.eventValue||0)),"function"==typeof g&&g()},function(){c.util.log("Some snippets failed")})};return h},render:function(a){return"Popup"==a.selectedVersion.template.type?this.renderPopup(a):"Persistent"==a.selectedVersion.template.type?this.renderPersistent(a):void c.util.log("Cannot render ad of type: "+a.selectedVersion.template.type)},renderPopup:function(a){var b=new c.renderers.popup(a.campaignId,a.id,a.selectedVersion.template);return b},renderPersistent:function(a){var b=null;try{b=new c.renderers.persistent(a.campaignId,a.id,a.selectedVersion.template)}catch(d){b=null}return b},getVersionDependencies:function(a){var b=[];if(!a.template||!a.template.panels)return[];for(var c=0;c<a.template.panels.length;c++)for(var d=a.template.panels[c],e=0;e<d.elements.length;e++){var f=d.elements[e];if(f.actions&&f.actions.length)for(var g=0;g<f.actions.length;g++){var h=f.actions[g];"trigger-ad"===h["class"]&&h.params.adId&&b.push(h.params)}}try{if("undefined"!=typeof a.linkedAds&&a.linkedAds&&a.linkedAds.length)for(var i=0;i<a.linkedAds.length;i++)b.push(a.linkedAds[i])}catch(f){}return b},enableCustomCSS:function(a,b,e){var f="";b.animationsCss&&(f+=b.animationsCss);var g=".exitintel-popup input:-webkit-autofill,.exitintel-popup input:-webkit-autofill:hover,.exitintel-popup input:-webkit-autofill:focus,.exitintel-popup input:-webkit-autofill:active {    -webkit-transition-delay: 9999s;    -webkit-transition: color 9999s ease-out, background-color 9999s ease-out;}";if(f+=g,b.customCSS&&(f+=b.customCSS),b.CSSSnippets)for(var h=0;h<b.CSSSnippets.length;h++)f+="\n"+b.CSSSnippets[h].source+"\n";if(e&&e.elementsCustomCSS&&e.elementsCustomCSS.length>0&&(f+="\n"+e.elementsCustomCSS.join("\n")+"\n"),""!==f){var i=d("<style>"+f+"</style>").attr("id","ei-style-"+a).attr("type","text/css");d("body").append(i)}if(e&&e.elementsStylesheets&&e.elementsStylesheets.length>0)for(var j=0;j<e.elementsStylesheets.length;j++)d("head").append(d("<link>").attr("rel","stylesheet").attr("href",c.config.cdnURL+c.ad.elementsStylesheets[j]))},disableCustomCSS:function(a){d("#ei-style-"+a).remove()},registerCSS:function(a,b){b.elementsCustomCSS.push(a)},registerStylesheet:function(a,b){-1===c.ad.elementsStylesheets.indexOf(a)&&b.elementsStylesheets.push(a)},runElementsAnimations:function(a,b){for(var d=0;d<a.panels[b].elements.length;d++){var e=a.panels[b].elements[d];if(e.animationEnabled){if(e.showOnMultipleSteps&&e.alreadyAnimated)continue;e.showOnMultipleSteps&&(e.alreadyAnimated=!0),c.util.log("Running animation for "+e.name),this.runElementAnimation(e)}}},runElementAnimation:function(a){var b=c.util.jQuery('[data-exitintel-name="'+a.name+'"]'),d=a.animation.effect&&a.animation.effect.split(":"),e=null,f=null;d&&(d[1]?(f=d[1],e=d[0]):(f=d[0],e="in")),!a.animation.effect||a.animation.effect&&"in"===e?b.hide():b.show(),setTimeout(function(){c.util.log("Starting animation for "+a.name),b.show(),c.util.runAnimation(b,f,a.animation.duration).then(function(){"out"===e&&b.hide(),b.css("animation-duration","")})},1e3*a.animation.delay)}},c.elementActions={timeout:null,runAction:function(a,b){var d=c.util.jQuery.data(a[0],"ei-actions");c.util.jQuery.data(a[0],"ei-action-status","pending"),c.plugins.activityIndicator.show(),d[b]?d[b]().then(function(){d[b+1]?c.elementActions.runAction(a,b+1):(c.plugins.activityIndicator.hide(),c.util.jQuery.data(a[0],"ei-action-status","done"))},function(){c.util.log("action "+b+" failed. Stopping"),c.plugins.activityIndicator.hide(),c.util.jQuery.data(a[0],"ei-action-status","failed")}):(c.util.log("action queue done"),c.plugins.activityIndicator.hide(),c.util.jQuery.data(a[0],"ei-action-status","done"))},install:function(a,b){var e=null,f=c.util.jQuery.data(a,"adObject"),g=c.campaign.get(f.campaignId),h=g.enabled_ads.filter(function(a){return a.id==f.adId}).pop();switch(b["class"]){case"goto-step":e=c.elementActionTypes.gotoStep.install(a,b);break;case"close-ad":e=c.elementActionTypes.closeAd.install(a,b);break;case"goto-url":e=c.elementActionTypes.gotoUrl.install(a,b);break;case"download-file":e=c.elementActionTypes.downloadFile.install(a,b);break;case"submit-form":e=c.elementActionTypes.submitForm.install(a,b);break;case"trigger-ad":e=c.elementActionTypes.triggerAd.install(a,b);break;case"collect-data":e=c.elementActionTypes.collectData.install(a,b);break;case"send-to-mailchimp":e=c.elementActionTypes.integrationMailchimp.install(a,b);break;case"custom-code":e=c.elementActionTypes.customCode.install(a,b);break;case"reload-ads":e=c.elementActionTypes.reloadAds.install(a,b);break;case"send-to-google-analytics":e=c.elementActionTypes.integrationGoogleAnalytics.install(a,b);break;case"send-to-integrations-manager":e=c.elementActionTypes.integrationsManager.install(a,b);break;case"fb-lead-event":e=c.elementActionTypes.fbLeadEvent.install(a,b);break;case"accept-decline-prompt":e=c.elementActionTypes.acceptDeclinePrompt.install(a,b);break;default:c.util.log("Action class '"+b["class"]+"' is not supported")}var i=c.util.jQuery.data(a[0],"ei-actions");if(i||(i=[],c.util.jQuery(a).on("click",function(a){a.preventDefault(),c.elementActions.runAction(d(this),0)})),e&&"collect-data"==b["class"]){if("undefined"!=typeof h&&"undefined"!=typeof h.snippets&&"undefined"!=typeof h.snippets["data-collection-js-pre"])for(var j=0;j<h.snippets["data-collection-js-pre"].length;j++){var k={params:{code:h.snippets["data-collection-js-pre"][j].source}},l=c.elementActionTypes.customCode.install(a,k);i.push(l)}if(i.push(e),"undefined"!=typeof h&&"undefined"!=typeof h.snippets&&"undefined"!=typeof h.snippets["data-collection-js-post"])for(var m=0;m<h.snippets["data-collection-js-post"].length;m++){var n={params:{code:h.snippets["data-collection-js-post"][m].source}},o=c.elementActionTypes.customCode.install(a,n);i.push(o)}}else e&&i.push(e);c.util.jQuery.data(a[0],"ei-actions",i)}},c.elementActionTypes={gotoStep:{install:function(a,b){var e=c.util.jQuery.data(a,"adObject");return function(){var f=new c.util.jQuery.Deferred;if(b.params.validateStep)for(var g=a.parents(".exitintel-panel"),h=g.find("input[data-exitintel-name],select[data-exitintel-name]"),i=0;i<h.length;i++){var j=h[i],k=d.data(j,"validators"),l=d(j).val();if(k)for(var m=0;m<k.length;m++)if(!k[m](l))return f.reject(),f.promise()}return e.showPanel(b.params.stepNumber,!0),f.resolve(),f.promise()}}},closeAd:{install:function(a,b){var d=c.util.jQuery.data(a,"adObject");return function(){var e=new c.util.jQuery.Deferred;d.hide(),c.visitor.setDisabledCampaign(d.campaignId);try{c.events.emit("ad-closed",{campaignId:d.campaignId,adId:d.adId,element:a.attr("data-exitintel-label")})}catch(f){c.util.error(f)}return b&&b.params&&b.params.reload&&c.elementActionTypes.reloadAds.install(a)(),e.resolve(),e.promise()}}},gotoUrl:{install:function(a,b){return b.params.newWindow&&a.on("click",function(){var a=window.open(b.params.url,"_blank");a.focus()}),function(){var a=new c.util.jQuery.Deferred;return b.params.newWindow?(a.resolve(),a.promise()):void(window.location.href=b.params.url)}}},downloadFile:{install:function(a,b){return b.params.newWindow&&a.on("click",function(){var a=window.open(c.config.cdnURL+"/file/get/"+b.params.file._id+"?download=false","_blank");a.focus()}),function(){b.params.newWindow||(window.location.href=c.config.cdnURL+"/file/get/"+b.params.file._id+"?download=true");var a=new c.util.jQuery.Deferred;return a.resolve(),a.promise()}}},submitForm:{install:function(a,b){"new-window"==b.params.submitMethod&&a.on("click",function(a){e().then(function(a){a&&a.submit()}),a.preventDefault()});var e=function(){var e=new c.util.jQuery.Deferred,f=c.util.jQuery.data(a,"adObject"),g=d("<form></form>").attr("action",b.params.url).attr("method","POST");switch(b.params.submitMethod){case"current-window":break;case"new-window":g.attr("target","blank");break;case"ajax":g.on("submit",function(a){a.preventDefault(),c.util.jQuery.post(b.params.url,d(this).serialize(),function(){e.resolve()}).fail(function(){alert("An error occured. Please check your data and try again later."),e.reject()})})}for(var h in b.params.includedData)if("function"!=typeof b.params.includedData[h]){var i=f.popupElement?f.popupElement:f.persistentElement,j=i.find('[data-exitintel-name="'+h+'"]'),k=j.val(),l=b.params.includedDataVarName[h],m=d.data(j[0],"validators");if(m)for(var n=0;n<m.length;n++)if(!m[n](k))return e.reject(),e.promise();var o=d("<input/>").attr("name",l).val(k);g.append(o)}if(b.params.additionalVars)for(var p in b.params.additionalVars){var q=b.params.additionalVars[p],r=d("<input/>").attr("name",q.name).val(q.value);g.append(r)}return c.util.jQuery("body").append(g),g.submit(),"ajax"!==b.params.submitMethod&&e.resolve(g),e.promise()};return"new-window"==b.params.submitMethod?function(){var a=new c.util.jQuery.Deferred;return a.resolve(),a.promise()}:e}},triggerAd:{install:function(a,b){return function(){for(var a=new c.util.jQuery.Deferred,d=0;d<c.campaign.available.length;d++){var e=c.campaign.available[d];if(e.id==b.params.campaignId){var f=null;if(b.params.adId){for(var g=0;g<e.enabled_ads.length;g++)if(e.enabled_ads[g].id==b.params.adId){f=e.enabled_ads[g];break}c.util.log("Could not find ad "+b.params.adId+" in enabled ads.")}else if(e.selectedAd)f=e.selectedAd;else{var h=Math.floor(Math.random()*e.enabled_ads.length);f=e.enabled_ads[h]}c.ad.install(f,{noTriggers:!0}).then(function(d){c.ad.showAdFunction(f,d,{})(function(){if("undefined"!=typeof b.params.step&&b.params.step){var a=parseInt(b.params.step,10);0===a&&a++,d.showPanel(a-1)}}),a.resolve()},function(){a.reject()})}}return a.promise()}}},collectData:{install:function(a,b){return function(){var e=new c.util.jQuery.Deferred,f=[],g=c.util.jQuery.data(a,"adObject");if(b.params&&b.params.includedData)for(var h in b.params.includedData)if("function"!=typeof b.params.includedData[h]&&b.params.includedData[h]!==!1){var i=g.popupElement?g.popupElement:g.persistentElement,j=i.find('[data-exitintel-name="'+h+'"]'),k=j.val(),l=b.params.includedDataVarName[h],m=d.data(j[0],"validators");if(m)for(var n=0;n<m.length;n++)if(!m[n](k))return e.reject(),e.promise();f.push({name:l,value:k,order:b.params.includedDataOrder&&b.params.includedDataOrder[h]?b.params.includedDataOrder[h]:0})}f.sort(function(a,b){return a.order<b.order?-1:a.order>b.order?1:0});var o={},p=[];try{p=f.map(function(a){return a.name})}catch(q){p=[]}for(var r=0;r<f.length;r++)o[f[r].name]=f[r].value;var s=c.campaign.get(g.campaignId),t=s.selectedAd;return c.visitor.setConvertedCampaign(g.campaignId,{adId:g.id}),c.event.log("collect-data",{campaignId:g.campaignId,adId:t.id,data:o,onDone:function(b){if(b){e.resolve();for(var d=0;d<p.length;d++)c.visitor.setGatheredData(p[d]);try{c.events.emit("data-collected",{campaignId:g.campaignId,adId:g.adId,element:a.attr("data-exitintel-label"),data:o})}catch(f){c.util.error(f)}}else alert("Your data was not sent. Please try again in a few moments."),e.reject()}}),e.promise()}}},customCode:{install:function(a,b){-1==b.params.code.indexOf("deferred.resolve()")&&(b.params.code+=";\ndeferred.resolve();"),-1==b.params.code.indexOf("return deferred.promise();")&&(b.params.code+=";\nreturn deferred.promise();");var d=new Function("deferred","element","action",b.params.code);return function(){var e=new c.util.jQuery.Deferred;return d(e,a,b)}}},integrationGoogleAnalytics:{install:function(a,b){return function(){var d=c.util.jQuery.data(a,"adObject"),e=new c.util.jQuery.Deferred,f=c.campaign.get(d.campaignId),g=f.selectedAd;return"undefined"==typeof b.params&&(b.params={}),c.integrations.ga.trackEvent(b.params.eventCategory||"Exit Intel",b.params.eventAction||"Conversion",b.params.eventLabel||f.title+" / "+g.title,b.params.eventValue||0),
e.resolve(),e.promise()}}},integrationMailchimp:{install:function(a,b){return function(){var e=c.util.jQuery.data(a,"adObject");b.params||(b.params={});var f=new c.util.jQuery.Deferred,g={};if(b.params&&b.params.includedData)for(var h in b.params.includedData)if("function"!=typeof b.params.includedData[h]){var i=e.popupElement?e.popupElement:e.persistentElement,j=i.find('[data-exitintel-name="'+h+'"]'),k=j.val(),l=b.params.includedDataVarName[h],m=d.data(j[0],"validators");if(m)for(var n=0;n<m.length;n++)if(!m[n](k))return f.reject(),f.promise();g[l]=k}return c.visitor.session.ip&&(g.optin_ip=c.visitor.session.ip),d.ajax({url:c.config.apiURL+"/integration/mailchimp/addToList/"+e.adId,jsonp:"callback",dataType:"jsonp",data:g,timeout:1e4,success:function(a){return"success"!=a.status?(alert("We were unable to process your information. Please check your email address and try again in a few moments."),void f.reject()):void f.resolve()},error:function(){alert("We were unable to process your information. Please check your email address and try again in a few moments."),f.reject()}}),f.promise()}}},reloadAds:{install:function(){return function(){for(var a=new c.util.jQuery.Deferred,b=0;b<c.campaign.available.length;b++)c.campaign.available[b].selectedAd=null;for(var d in c.ad.visibleAds){var e=c.ad.visibleAds[d];"function"!=typeof e&&e&&e.hide()}return c.ad.installedAds={},c.campaign.active=[],c.trigger.uninstallAll(),c.ad.adTriggers={},c.campaign.campaignsLoaded(),a.resolve(),a}}},integrationsManager:{install:function(a,b){return function(){var e=c.util.jQuery.data(a,"adObject");b.params||(b.params={});var f=new c.util.jQuery.Deferred,g={},h=e.popupElement?e.popupElement:e.persistentElement;if(b.params&&b.params.fields)for(var i in b.params.fields){var j=h.find('[data-exitintel-name="'+i+'"]'),k=j.val(),l=b.params.fields[i],m=d.data(j[0],"validators");if(m)for(var n=0;n<m.length;n++)if(!m[n](k))return f.reject(),f.promise();g[l]=k}if(b.params){var o=b.params.integration.split(":"),p=o[0].toLowerCase(),q=o[1],r=h.find('[data-exitintel-name="'+b.params.emailField+'"]'),s=r.val();c.integrations[p].send(q,s,g,!1).fail(function(){alert("We were unable to process your information. Please check your email address and try again in a few moments."),f.reject()}).done(function(){f.resolve()})}return f.promise()}}},fbLeadEvent:{install:function(a,b){return function(){b.params||(b.params={});var a=new c.util.jQuery.Deferred;return window.fbq&&"function"==typeof window.fbq&&window.fbq("track","Lead",b.params),a.resolve(),a}}},acceptDeclinePrompt:{install:function(a,b){return function(){var d=c.util.jQuery.Deferred(),e=c.util.jQuery.Deferred(),f=[{code:"AT",name:"Austria"},{code:"BE",name:"Belgium"},{code:"BG",name:"Bulgaria"},{code:"HR",name:"Croatia"},{code:"CY",name:"Republic of Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"EE",name:"Estonia"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"DE",name:"Germany"},{code:"GR",name:"Greece"},{code:"HU",name:"Hungary"},{code:"IE",name:"Ireland"},{code:"IT",name:"Italy"},{code:"LV",name:"Latvia"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MT",name:"Malta"},{code:"NL",name:"Netherlands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"RO",name:"Romania"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"ES",name:"Spain"},{code:"SE",name:"Sweden"},{code:"GB",name:"UK"}];b.params||(b.params={});var g=c.cookie.get("userCountry");return g?setTimeout(function(){e.resolve(g)}):c.util.getCountry().then(function(a){c.cookie.set("userCountry",a,100),e.resolve(a)}),e.promise().then(function(e){var g=b.params.countries;if(-1!==g.indexOf("EU")&&(g=g.filter(function(a){return"EU"!==a}).concat(f.map(function(a){return a.code}))),g.length>0&&-1===g.indexOf(e))return void d.resolve();var h='<div class="exi_alert"><div class="exi_alert_overlay_cover"></div><div class="exi_css_reset exi_alert_container exi_alert_defaults"><div class="exi_css_reset exi_alert_container_inner exi_alert_defaults"><div class="exi_alert_title exi_alert_defaults"><img src="'+("eu"===b.params.icon?"https://assets.exitintel.com/eu_gdpr.png":c.config.cdnURL+b.params.customIcon)+'" width="25" height="25" class="exi_gdpr_icon">'+b.params.title+'</div><div class="exi_alert_body exi_alert_defaults">'+b.params.body+'</div><div class="exi_alert_actions exi_alert_defaults"><a href="#" class="exi_css_reset exi_alert_defaults exi_alert_action_secondary">'+b.params.decline.text+'</a><a href="#" class="exi_css_reset exi_alert_defaults exi_alert_action_primary">'+b.params.accept.text+'</a></div></div><div class="exi_below_alert_copy">'+b.params.footnote+"</div></div></div>";c.util.jQuery("body").append(h),c.util.jQuery(".exi_alert").fadeIn(200),c.util.jQuery(".exi_alert .exi_alert_action_secondary").click(function(){if(c.util.jQuery(".exi_alert").remove(),"goto-step"===b.params.decline.action){var e=c.util.jQuery.data(a,"adObject");e.showPanel(b.params.decline.step,!0)}d.reject()}),c.util.jQuery(".exi_alert .exi_alert_action_primary").click(function(){c.util.jQuery(".exi_alert").remove(),d.resolve()})}),d}}}},c.renderers={setZIndexes:function(a,b,c){c=c||0;for(var d=0;d<b.length;d++)a.find('[data-exitintel-name="'+b[d]+'"]').css({zIndex:c+b.length-d})},setAbsoluteElementAxisPosition:function(a,b,d){for(var e=0;e<a.length;e++){var f=a[e];if(b.position[f]){d.css(f,c.util.sizeFormat(b.position[f]));break}}},setElementPosition:function(a,b){if(b.position.mode||(b.position.mode="exact"),(b.position.mode&&"exact"===b.position.mode||"exact-horizontal-relative-vertical"==b.position.mode)&&c.renderers.setAbsoluteElementAxisPosition(["left","right"],b,a),(b.position.mode&&"exact"===b.position.mode||"relative-horizontal-exact-vertical"==b.position.mode)&&c.renderers.setAbsoluteElementAxisPosition(["top","bottom"],b,a),b.position.mode&&"relative"===b.position.mode||"relative-horizontal-exact-vertical"==b.position.mode)switch(b.position.setX){case"left":a.css("left",b.position.horizontalOffset||"0px");break;case"right":a.css("right",b.position.horizontalOffset||"0px");break;case"center":a.css("left","calc(50% - "+b.size.width+" / 2"+(b.position.horizontalOffset?" + ("+b.position.horizontalOffset+")":"")+")")}if(b.position.mode&&"relative"===b.position.mode||"exact-horizontal-relative-vertical"==b.position.mode)switch(b.position.setY){case"top":a.css("top",b.position.verticalOffset||"0px");break;case"bottom":a.css("bottom",b.position.verticalOffset||"0px");break;case"middle":a.css("top","calc(50% - "+b.size.height+" / 2"+(b.position.verticalOffset?" + ("+b.position.verticalOffset+")":"")+")")}},setElementBackground:function(a,b){if(b.transparent)a.css("background","transparent");else if(b.backgroundColor.match(/gradient/)){var d=b.backgroundColor.match(/gradient\((.*)\)/)[1].split(",").slice(1).join(",").trim().split("%")[0].match(/(rgb\([^\)]+\)|rgba\([^\)]+\))/)[1];a.css("background",d),a.css("background",b.backgroundColor)}else a.css("background",b.backgroundColor);b.backgroundImage&&(a.css({"background-image":"url("+c.config.cdnURL+b.backgroundImage+")","background-repeat":"no-repeat"}),b.backgroundPosition&&a.css({"background-position":""+b.backgroundPosition.horizontal+" "+b.backgroundPosition.vertical}),b.backgroundSize?a.css({"background-size":b.backgroundSize}):a.css({"background-size":"100%"}))},setElementOpacity:function(a,b){a.css({opacity:isNaN(parseInt(b.opacity))?1:(parseInt(b.opacity)/100).toFixed(2)})},setElementRotation:function(a,b){var c=parseInt(b.rotation);isNaN(c)||a.css({transform:"rotate("+c+"deg)","-o-transform":"rotate("+c+"deg)","-ms-transform":"rotate("+c+"deg)","-moz-transform":"rotate("+c+"deg)","-webkit-transform":"rotate("+c+"deg)"})}},c.renderers=c.renderers||{},c.renderers.popup=function(a,b,e){if(c.util.log("Creating popup"),this.campaignId=a,this.adId=b,this.wrapperElement=d("<div></div>").addClass("exitintel-wrapper").attr("id","exitintel_wrapper_"+this.adId),this.animationsCss="",this.currentPanel=null,this.showCallbacks=[],this.elementsCustomCSS=[],this.elementsStylesheets=[],this.template=e,this.overlayElement=d("<div></div>").addClass("exitintel-overlay").attr("id","exitintel_ovelay_"+this.adId).css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":"81000003",display:"none"}),c.renderers.setElementBackground(this.overlayElement,{backgroundColor:e.overlayBackgroundColor||"rgba(0, 0, 0, 0.8)",backgroundImage:e.overlayBackgroundImage,backgroundPosition:e.overlayBackgroundPosition,backgroundSize:"cover"}),this.popupElement=d("<form></form>").addClass("exitintel-popup").attr("id","exitintel_popup_"+this.adId).css({position:"absolute",width:e.width,height:e.height,margin:0,padding:0,left:"50%","margin-left":-1*parseInt(e.width,10)/2+"px",top:"50%","margin-top":-1*parseInt(e.height,10)/2+"px",display:"none"}),this.popupElement.on("submit",function(a){a.preventDefault()}),c.renderers.setElementBackground(this.popupElement,e),!c.config.whitelabel&&"dont-show"!==e.brandingLink){var f=d("<a></a>").addClass("exitintel-branding-link").attr("href","https://www.exitintel.com/?utm_source=powered_by_link&utm_medium=referral&utm_campaign="+window.location.hostname).attr("target","_blank").html("Powered by <strong>Exit Intelligence</strong>").css({color:"white","font-family":"Arial, Helvetica, sans-serif","font-size":"12px",position:"absolute",bottom:"20px","text-decoration":"none"});""!==e.brandingLink&&e.brandingLink||f.css("left","20px"),"bottom-right"===e.brandingLink&&f.css("right","20px");var g="white";try{g=c.util.getContrastingColor(e.overlayBackgroundColor,!0)}catch(h){g="white"}if(f.css({color:g}),"fancy"==c.config.brandingType){var i="light",j="FFF";"#000000"==g&&(i="dark",j="000"),f.html('<img src="'+c.config.cdnURL+"/file/get/ei-logo-"+i+'.svg" />'),f.find("img").css({width:"200px",height:"auto"}),f.css({border:"1px solid #"+j+"b","border-radius":"5px",padding:"5px 10px"});var k="";k+=".exitintel-branding-link:hover { transform: scale(1.1); opacity: 1; }",k+=".exitintel-branding-link { transition: .3s; opacity: 0.8; }";var l=d("<style>"+k+"</style>").attr("id","ei-style-branding").attr("type","text/css");this.overlayElement.append(l)}this.overlayElement.append(f)}c.util.log("Rendering panels");for(var m=0;m<e.panels.length;m++)this.renderPanel(m,e.panels[m]);this.overlayElement.append(this.popupElement),this.wrapperElement.append(this.overlayElement),d("body").append(this.wrapperElement);var n=this,o=e;c.util.log("Installing default handler for enter"),this.popupElement.keypress(function(a){if(13==a.keyCode){var b=o.panels[n.currentPanel];if(null===b)return void c.util.log("No current panel. Cannot trigger default action");if(b.onEnter){var d=n.popupElement;d.find("#exitintel_panel_"+n.currentPanel+' [data-exitintel-name="'+b.onEnter+'"]').click()}}})},c.renderers.popup.prototype.renderPanel=function(a,b){var e=d("<div></div>").addClass("exitintel-panel").attr("id","exitintel_panel_"+a).attr("data-panel-id",a).css({position:"absolute",width:"100%",height:"100%"});if(b.backgroundImage)if("undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9){var f=d("<div></div>");f.attr("style","position:relative;width:100%;height:100%;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+c.config.cdnURL+b.backgroundImage+"', sizingMethod='scale')"),e.append(f)}else e.css({background:"transparent url('"+c.config.cdnURL+b.backgroundImage+"') 0 0 no-repeat","background-size":"100% 100%"});b.backgroundPosition&&e.css({"background-position":""+b.backgroundPosition.horizontal+" "+b.backgroundPosition.vertical});for(var g={label:"label","input-email":"inputEmail","input-general":"inputGeneral",button:"button",countdown:"countdown"},h=0;h<b.elements.length;h++){var i=b.elements[h],j=g[i.type],k=c.renderers.element[j](i,this),l=null;k.attr("data-element-panel-id",a),i.backgroundColor&&"undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9&&(i.backgroundColor=i.backgroundColor.replace(/^rgba\((\d+)[^\d]+(\d+)[^\d]+(\d+)*/,"rgb($1, $2, $3)"));var m=parseInt(i.rotation);if(isNaN(m)||0===m?(k.css({"text-align":i.align,position:"absolute",width:c.util.sizeFormat(i.size.width),height:c.util.sizeFormat(i.size.height),font:i.font.weight+" "+i.font.size+"px "+i.font.family,"line-height":i.font.height+"px",color:i.color,border:"none",padding:0,outline:"none"}),c.renderers.setElementPosition(k,i),c.renderers.setElementBackground(k,i),c.renderers.setElementOpacity(k,i)):(l=d("<div/>"),l.css({position:"absolute",width:c.util.sizeFormat(i.size.width),height:c.util.sizeFormat(i.size.height),border:"none",padding:0,outline:"none"}),k.css({"text-align":i.align,width:"100%",height:"100%",font:i.font.weight+" "+i.font.size+"px "+i.font.family,"line-height":i.font.height+"px",color:i.color,border:"none",padding:0,outline:"none"}),c.renderers.setElementPosition(l,i),c.renderers.setElementBackground(k,i),c.renderers.setElementOpacity(k,i),c.renderers.setElementRotation(l,i),l.append(k)),"undefined"!=typeof i.classNames)try{var n=i.classNames.split(" ");for(var o in n)k.addClass(n[o])}catch(p){}"string"==typeof i.additionalStyles&&k.attr("style",k.attr("style")+";"+i.additionalStyles),i.customCSS&&this.elementsCustomCSS.push(i.customCSS),i.hover&&i.hover.enabled&&(k.css("transition-duration",i.hover.duration+"s"),"crossfade"!==i.hover.effect?k.addClass("hvr-"+i.hover.effect):k.css("transition-properties","all"),i.hover.image&&this.elementsCustomCSS.push('[data-exitintel-name="'+i.name+"\"]:hover { background-image: url('"+c.config.cdnURL+i.hover.image+"') !important; } ")),"outer"==i.container?this.overlayElement.append(l||k):e.append(l||k)}this.popupElement.append(e)},c.renderers.popup.prototype.showPanel=function(a,b){var d=null,e=null,f=.2;b&&this.template.animations&&this.template.animations.transition&&this.template.animations.transition.effect&&(d=this.template.animations.transition.effect.animations[0],e=this.template.animations.transition.effect.animations[1],this.template.animations.transition.duration&&(f=this.template.animations.transition.duration)),d?c.util.runAnimation(this.popupElement,d,f/2).then(function(){this.showPanelNext(a,e,f/2)}.bind(this)):this.showPanelNext(a,e,f)},c.renderers.popup.prototype.showPanelNext=function(a,b){this.popupElement.find(".exitintel-panel").hide(),this.overlayElement.find("[data-element-panel-id][data-element-panel-id!="+a+"]").hide(),b&&c.util.runAnimation(this.popupElement,b,.5),this.overlayElement.find("[data-element-panel-id="+a+"]").show(),this.popupElement.find("[data-panel-id="+a+"]").show(),this.currentPanel=a,this.template.panels[a].layers&&(c.renderers.setZIndexes(this.overlayElement,this.template.panels[a].layers["outer-below-inner"]),this.popupElement.css({zIndex:this.template.panels[a].layers["outer-below-inner"].length+1}),c.renderers.setZIndexes(this.popupElement,this.template.panels[a].layers.inner),c.renderers.setZIndexes(this.overlayElement,this.template.panels[a].layers["outer-above-inner"],this.template.panels[a].layers["outer-below-inner"].length+1)),c.ad.runElementsAnimations(this.template,a)},c.renderers.popup.prototype.show=function(){if(c.util.log("Showing ad"),this.wrapperElement.show(),this.overlayElement.show(),this.template.animations&&this.template.animations.appearence&&this.template.animations.appearence.effect&&c.util.runAnimation(this.popupElement,this.template.animations.appearence.effect,this.template.animations.appearence.duration||.2),this.template.animations&&this.template.animations.overlayAppearence&&this.template.animations.overlayAppearence.effect&&c.util.runAnimation(this.overlayElement,this.template.animations.overlayAppearence.effect,this.template.animations.overlayAppearence.duration||.2),this.popupElement.show(),this.showPanel(0),c.ad.visibleAds.popup=this,this.showCallbacks.length)for(var a=0;a<this.showCallbacks.length;a++)this.showCallbacks[a].call();c.ad.enableCustomCSS(this.adId,this.template,this),"object"==typeof c.util.iOSversion()&&11==c.util.iOSversion()[0]&&(c.visitor.session.currentScroll=c.util.jQuery(window).scrollTop(),c.ad.enableCustomCSS("ios11-fix",{customCSS:"body { position: fixed !important; } html,body{ -webkit-overflow-scrolling : touch !important; overflow: auto !important; height: 100% !important; width: 100% !important } "}))},c.renderers.popup.prototype.hide=function(){var a=[];this.template.animations&&this.template.animations.overlayClosing&&this.template.animations.overlayClosing.effect&&a.push(c.util.runAnimation(this.overlayElement,this.template.animations.overlayClosing.effect,this.template.animations.overlayClosing.duration||.2)),this.template.animations&&this.template.animations.closing&&this.template.animations.closing.effect&&a.push(c.util.runAnimation(this.popupElement,this.template.animations.closing.effect,this.template.animations.closing.duration||.2)),a.length?d.when.apply(d,a).then(this.hideDone.bind(this)):this.hideDone()},c.renderers.popup.prototype.hideDone=function(){this.wrapperElement.hide(),this.overlayElement.hide(),this.popupElement.hide(),c.ad.visibleAds.popup=null,c.ad.disableCustomCSS(this.adId),"object"==typeof c.util.iOSversion()&&11==c.util.iOSversion()[0]&&(c.ad.disableCustomCSS("ios11-fix"),c.util.jQuery(window).scrollTop(c.visitor.session.currentScroll))},c.renderers=c.renderers||{},c.renderers.persistent=function(a,b,e){this.campaignId=a,this.adId=b,this.panels=[],this.showCallbacks=[],this.elementsCustomCSS=[],this.elementsStylesheets=[],this.template=e,this.wrapperElement=d("<div></div>").addClass("exitintel-wrapper").attr("id","exitintel_wrapper_"+this.adId),e.backgroundColor&&"undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9&&(e.backgroundColor.match(/rgba\(.*,[^d]*0\)/)?e.backgroundColor="transparent":e.backgroundColor=e.backgroundColor.replace(/^rgba\((\d+)[^\d]+(\d+)[^\d]+(\d+).*/,"rgb($1, $2, $3)"));var f="fixed";if(e.persistentPosition&&e.persistentPosition.type)switch(e.persistentPosition.type){case"element-before":case"element-inside-top":case"element-inside-bottom":case"element-after":f="relative";break;default:f="fixed"}this.persistentElement=d("<form></form>").addClass("exitintel-persistent").attr("id","exitintel_persistent_"+this.adId).css({position:f,display:"none","text-align":"center","z-index":81e6,margin:0,padding:0}),this.persistentElement.on("submit",function(a){a.preventDefault()}),c.renderers.setElementBackground(this.persistentElement,e),this.innerCanvasElement=d("<div></div>").addClass("exitintel-inner-canvas").attr("id","exitintel_persistent_"+this.adId).css({position:"relative","background-color":"transparent","text-align":"center","z-index":81000001,margin:"auto",top:0,width:e.persistentInnerCanvasPosition.width,height:e.persistentInnerCanvasPosition.height});var g={top:"top",bottom:"bottom",left:"left",right:"right",marginLeft:"margin-left",marginTop:"margin-top",width:"width",height:"height"};for(var h in g)if("function"!=typeof g[h]){var i=e.persistentPosition[h];"undefined"!=typeof i&&this.persistentElement.css(g[h],i)}if(e.persistentPosition.rotation){if(this.persistentElement.css("pointer-events","none"),"undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9)return!1;for(var j=["transform","-webkit-transform","-moz-transform","-ms-transform"],k=0;k<j.length;k++)this.persistentElement.css(j[k],"rotate("+e.persistentPosition.rotation+"deg)"),this.persistentElement.css(j[k]+"-origin","0 0")}for(var l=0;l<e.panels.length;l++)this.renderPanel(l,e.panels[l]);if(this.persistentElement.append(this.innerCanvasElement),this.wrapperElement.append(this.persistentElement),e.persistentPosition&&e.persistentPosition.type){switch(e.persistentPosition.type){case"element-before":case"element-inside-top":case"element-inside-bottom":case"element-after":try{if(0===d(e.persistentPosition.element).length)throw"Cannot find element: "+e.persistentPosition.element}catch(m){throw m}}switch(e.persistentPosition.type){case"element-before":this.wrapperElement.insertBefore(e.persistentPosition.element);break;case"element-inside-top":d(e.persistentPosition.element).prepend(this.wrapperElement);break;case"element-inside-bottom":d(e.persistentPosition.element).append(this.wrapperElement);break;case"element-after":this.wrapperElement.insertAfter(e.persistentPosition.element);break;default:d("body").append(this.wrapperElement)}}else d("body").append(this.wrapperElement)},c.renderers.persistent.prototype.renderPanel=function(a,b){var e=d("<div></div>").addClass("exitintel-panel").attr("id","exitintel_panel_"+a).attr("data-panel-id",a).css({position:"absolute",width:"100%",height:"100%","z-index":"81000004"});if(b.backgroundImage)if("undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9){var f=d("<div></div>");f.attr("style","position:relative;width:100%;height:100%;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+c.config.cdnURL+b.backgroundImage+"', sizingMethod='scale')"),e.append(f)}else e.css({background:"transparent url('"+c.config.cdnURL+b.backgroundImage+"') 0 0 no-repeat","background-size":"100% 100%"});b.backgroundPosition&&e.css({"background-position":""+b.backgroundPosition.horizontal+" "+b.backgroundPosition.vertical});for(var g={label:"label","input-email":"inputEmail","input-general":"inputGeneral",button:"button",countdown:"countdown"},h=0;h<b.elements.length;h++){var i=b.elements[h],j=g[i.type],k=c.renderers.element[j](i,this),l=null;k.attr("data-element-panel-id",a);var m=parseInt(i.rotation);if(isNaN(m)||0===m?(k.css({"text-align":i.align,position:"absolute",width:c.util.sizeFormat(i.size.width),height:c.util.sizeFormat(i.size.height),font:i.font.weight+" "+i.font.size+"px "+i.font.family,"line-height":i.font.height+"px",color:i.color,border:"none",padding:0,outline:"none"}),c.renderers.setElementPosition(k,i),c.renderers.setElementBackground(k,i),c.renderers.setElementOpacity(k,i)):(l=d("<div/>"),l.css({position:"absolute",width:c.util.sizeFormat(i.size.width),height:c.util.sizeFormat(i.size.height),border:"none",padding:0,outline:"none"}),k.css({"text-align":i.align,width:"100%",height:"100%",font:i.font.weight+" "+i.font.size+"px "+i.font.family,"line-height":i.font.height+"px",color:i.color,border:"none",padding:0,outline:"none"}),c.renderers.setElementPosition(l,i),c.renderers.setElementBackground(k,i),c.renderers.setElementOpacity(k,i),c.renderers.setElementRotation(l,i),l.append(k)),"undefined"!=typeof i.classNames)try{var n=i.classNames.split(" ");for(var o in n)k.addClass(n[o])}catch(p){}"string"==typeof i.additionalStyles&&k.attr("style",k.attr("style")+";"+i.additionalStyles),i.customCSS&&this.elementsCustomCSS.push(i.customCSS),i.hover&&i.hover.enabled&&(k.css("transition-duration",i.hover.duration+"s"),"crossfade"!==i.hover.effect?k.addClass("hvr-"+i.hover.effect):k.css("transition-properties","all"),i.hover.image&&this.elementsCustomCSS.push('[data-exitintel-name="'+i.name+"\"]:hover { background-image: url('"+c.config.cdnURL+i.hover.image+"') !important; } ")),"outer"==i.container?this.persistentElement.append(l||k):e.append(l||k)}this.innerCanvasElement.append(e)},c.renderers.persistent.prototype.showPanel=function(a,b){var d=null,e=null,f=.2;b&&this.template.animations&&this.template.animations.transition&&this.template.animations.transition.effect&&(d=this.template.animations.transition.effect.animations[0],e=this.template.animations.transition.effect.animations[1],this.template.animations.transition.duration&&(f=this.template.animations.transition.duration)),d?c.util.runAnimation(this.innerCanvasElement,d,f/2).then(function(){this.showPanelNext(a,e,f/2)}.bind(this)):this.showPanelNext(a,e,f)},c.renderers.persistent.prototype.showPanelNext=function(a,b){this.persistentElement.find(".exitintel-panel").hide(),this.persistentElement.find("[data-element-panel-id][data-element-panel-id!="+a+"]").hide(),b&&c.util.runAnimation(this.innerCanvasElement,b,.5),this.persistentElement.find("[data-element-panel-id="+a+"]").show(),this.persistentElement.find("[data-panel-id="+a+"]").show(),this.currentPanel=a,this.template.panels[a].layers&&(c.renderers.setZIndexes(this.persistentElement,this.template.panels[a].layers["outer-below-inner"]),this.innerCanvasElement.css({zIndex:this.template.panels[a].layers["outer-below-inner"].length+1}),c.renderers.setZIndexes(this.innerCanvasElement,this.template.panels[a].layers.inner),c.renderers.setZIndexes(this.persistentElement,this.template.panels[a].layers["outer-above-inner"],this.template.panels[a].layers["outer-below-inner"].length+1)),c.ad.runElementsAnimations(this.template,a)},c.renderers.persistent.prototype.show=function(){if(this.wrapperElement.show(),this.persistentElement.show(),this.template.animations&&this.template.animations.appearence&&this.template.animations.appearence.effect&&c.util.runAnimation(this.persistentElement,this.template.animations.appearence.effect,this.template.animations.appearence.duration||.2),this.showPanel(0),c.ad.visibleAds.persistent=this,this.showCallbacks.length)for(var a=0;a<this.showCallbacks.length;a++)this.showCallbacks[a].call();c.ad.enableCustomCSS(this.adId,this.template,this)},c.renderers.persistent.prototype.hide=function(){this.template.animations&&this.template.animations.closing&&this.template.animations.closing.effect?c.util.runAnimation(this.persistentElement,this.template.animations.closing.effect,this.template.animations.closing.duration||.2).then(this.hideDone.bind(this)):this.hideDone()},c.renderers.persistent.prototype.hideDone=function(){this.wrapperElement.hide(),this.persistentElement.hide(),c.ad.visibleAds.persistent=null,c.ad.disableCustomCSS(this.adId)},c.renderers=c.renderers||{},c.renderers.element={label:function(a,b){var e=d("<div></div>");e.attr("data-exitintel-name",a.name),e.attr("data-exitintel-label",a.label),e.html(a.placeholder),e.css({"pointer-events":"auto"});var f=a.customCSS||"";return c.ad.registerCSS(f,b),e},inputEmail:function(a,b){var e=d("<input />");e.attr("type","email"),e.attr("name","email"),e.attr("data-exitintel-name",a.name),e.attr("data-exitintel-label",a.label),e.attr("placeholder",a.placeholder),e.css({"pointer-events":"auto"}),c.util.isPlaceholderSupported()||c.plugins.customPlaceholders(e);var f=[];f.push(function(a){if(""===a)return!0;var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)?!0:(alert("Your email address format is wrong."),!1)}),a.required&&(e.attr("required","required"),f.push(function(a){return""===a?(alert("Please fill in all the required fields."),!1):!0})),c.util.jQuery.data(e[0],"validators",f),e.on("keypress",function(a){13==a.which&&a.preventDefault()});var g=a.customCSS||"";return c.ad.registerCSS(g,b),e},inputGeneral:function(a,b){var e=d("<input />");e.attr("type","text"),a.label.match(/input-/)&&e.attr("name",a.label.replace(/input-/,"")),e.css({"pointer-events":"auto"}),e.attr("data-exitintel-name",a.name),e.attr("data-exitintel-label",a.label),e.attr("placeholder",a.placeholder),c.util.isPlaceholderSupported()||c.plugins.customPlaceholders(e);var f=[];a.required&&(e.attr("required","required"),f.push(function(a){return""===a?(alert("Please fill in all the required fields."),!1):!0})),c.util.jQuery.data(e[0],"validators",f),e.on("keypress",function(a){13==a.which&&a.preventDefault()});var g=a.customCSS||"";return c.ad.registerCSS(g,b),e},button:function(a,b){var e=d("<button />");if(e.html(a.placeholder),e.attr("data-exitintel-name",a.name),e.attr("data-exitintel-label",a.label),e.css({cursor:"pointer","pointer-events":"auto"}),c.util.jQuery.data(e,"adObject",b),a.actions)for(var f=0;f<a.actions.length;f++)c.elementActions.install(e,a.actions[f]);var g=a.customCSS||"";if("close-button"===a.subtype){e.addClass("exi_close_x_thin");var h=[];h.push("[data-exitintel-name="+a.name+"]::before"),h.push("[data-exitintel-name="+a.name+"]::after"),g+="\n\n"+h.join(", \n")+" {  background-color: "+a.closeButton.color+"; \n height: "+a.closeButton.thickness+("number"==typeof a.closeButton.thickness?"px":"")+"; \n border-radius: "+a.closeButton.radius+("number"==typeof a.closeButton.radius?"px":"")+"; \n top: "+(parseInt(a.size.height,10)-a.closeButton.thickness)/2+"px}"}return c.ad.registerCSS(g,b),e},countdown:function(a,b){var e=d("<div></div>").addClass("countdown");e.css({"pointer-events":"auto"});var f=b.campaignId+":"+a.name,g=new c.plugins.countdown(f,e,a.countdown);b.showCallbacks.push(g.start.bind(g));var h=a.customCSS||"";return c.ad.registerCSS(h,b),e}},c.plugins=c.plugins||{},c.plugins.countdown=function(a,b,d){if(this.id=a,this.settings=d,this.$el=b,this.secondsOffset=0,this.startedAt=null,"undefined"==typeof this.settings.timeTargetType||"relative"==this.settings.timeTargetType){var e=c.cookie.getJSON("countdowns",{});e&&e[this.id]&&(this.startedAt=e[this.id].startedAt)}if(d.hours&&(this.secondsOffset+=3600*parseInt(d.hours,10)),d.minutes&&(this.secondsOffset+=60*parseInt(d.minutes,10)),d.seconds&&(this.secondsOffset+=parseInt(d.seconds,10)),d.customizeCountdown){var f=[];this.settings.splitHoursDays&&this.settings.showDays&&f.push("days"),this.settings.showHours&&f.push("hours"),this.settings.showMinutes&&f.push("minutes"),this.settings.showSeconds&&f.push("seconds");var g='<span data-ei-class="hm-seperator">:</span>',h=f.map(function(a){return'<span data-ei-class="'+a+'">00</span>'}).join(g);this.$el.html(h)}else this.$el.html('<span data-ei-class="hours">00</span><span data-ei-class="ms-seperator">:</span><span data-ei-class="minutes">00</span><span data-ei-class="ms-seperator">:</span><span data-ei-class="seconds">00</span>')},c.plugins.countdown.prototype.start=function(){if(!this.startedAt)if(this.settings.timeTargetType&&"absolute"==this.settings.timeTargetType){var a=new Date(this.settings.timeTarget).valueOf();a-=3600*this.settings.hours*1e3,a-=60*this.settings.minutes*1e3,a-=1e3*this.settings.seconds,this.startedAt=Math.floor(a/1e3)}else{var b=Math.floor(Date.now()/1e3),d=c.cookie.getJSON("countdowns",{}),e={startedAt:b};d[this.id]=e,c.cookie.setJSON("countdowns",d),this.startedAt=b}this.tick()},c.plugins.countdown.prototype.tick=function(){var a=Math.floor(Date.now()/1e3),b=this.startedAt+this.secondsOffset,c=b-a;if(0>=c)return this.setElement("days",0),this.setElement("hours",0),this.setElement("minutes",0),void this.setElement("seconds",0);var d=Math.floor(c/3600),e=Math.floor(c%3600/60),f=c%60;this.settings.splitHoursDays?(this.setElement("days",Math.floor(d/24)),this.setElement("hours",d%24)):this.setElement("hours",d),this.setElement("minutes",e),this.setElement("seconds",f),setTimeout(this.tick.bind(this),1e3)},c.plugins.countdown.prototype.setElement=function(a,b){var c=b;10>c&&(c="0"+c),this.$el.find('[data-ei-class="'+a+'"]').html(c),"hours"==a&&0===b&&(this.$el.find('[data-ei-class="hours"]').hide(),this.$el.find('[data-ei-class="hm-seperator"]').hide())},c.plugins=c.plugins||{},c.plugins.activityIndicator={installed:!1,overlayElement:null,indicatorElement:null,timeout:null,install:function(){this.overlayElement=d("<div></div>").addClass("exitintel-overlay").attr("id","exitintel_activity_indicator_ovelay").css({position:"fixed",top:0,left:0,background:"rgba(255, 255, 255, 0.6)",width:"100%",height:"100%","z-index":"81000006",display:"none"}),"undefined"!=typeof c.util.ieVersion()&&c.util.ieVersion()<9&&this.overlayElement.css("background","transparent"),this.indicatorElement=d("<div></div>").addClass("exitintel-activity-indicator").attr("id","exitintel_activity_indicator").css({position:"absolute",width:100,height:100,left:"50%","margin-left":-50,top:"30%","margin-top":-50}),this.indicatorElement.html('<div id="exitintel-spinner"></div>');var a=document.createElement("style");a.setAttribute("id","ei-style-spinner"),a.setAttribute("type","text/css"),a.type="text/css";var b="#exitintel-spinner:before,#exitintel-spinner:after,#exitintel-spinner {border-radius: 50%;width: 2.5em;height: 2.5em;-webkit-animation-fill-mode: both;animation-fill-mode: both;-webkit-animation: exitintel-activity-animation 1.8s infinite ease-in-out;animation: exitintel-activity-animation 1.8s infinite ease-in-out;}#exitintel-spinner {margin: 8em auto;font-size: 10px;position: relative;text-indent: -9999em;-webkit-animation-delay: 0.16s;animation-delay: 0.16s;}#exitintel-spinner:before {left: -3.5em;}#exitintel-spinner:after {left: 3.5em;-webkit-animation-delay: 0.32s;animation-delay: 0.32s;}#exitintel-spinner:before,#exitintel-spinner:after {content: '';position: absolute;top: 0;}@-webkit-keyframes exitintel-activity-animation {0%,80%,100% {box-shadow: 0 2.5em 0 -1.3em "+c.config.primaryBrandColor+";}40% {box-shadow: 0 2.5em 0 0 "+c.config.primaryBrandColor+";}}@keyframes exitintel-activity-animation {0%,80%,100% {box-shadow: 0 2.5em 0 -1.3em "+c.config.primaryBrandColor+";}40% {box-shadow: 0 2.5em 0 0 "+c.config.primaryBrandColor+";}}";
a.styleSheet?a.styleSheet.cssText=b:a.appendChild(document.createTextNode(b)),d("body").append(a),this.overlayElement.append(this.indicatorElement),d("body").append(this.overlayElement)},show:function(){this.installed||this.install(),this.installed=!0,this.overlayElement.show(),clearTimeout(c.plugins.activityIndicator.timeout),c.plugins.activityIndicator.timeout=setTimeout(function(){var a=c.ad.visibleAds.popup?c.ad.visibleAds.popup:c.ad.visibleAds.persistent;c.report.error("timeout","Element actions reached timeout",{},{campaignId:a.campaignId,adId:a.adId}),c.plugins.activityIndicator.hide(),c.util.jQuery(".exi_alert").remove(),"undefined"==typeof window._exiq&&(window._exiq=[]),window._exiq.push(["disableCampaigns"])},1e4)},hide:function(){this.overlayElement.hide(),clearTimeout(c.plugins.activityIndicator.timeout)}},c.plugins=c.plugins||{},c.plugins.customPlaceholders=function(a){function b(){d(this).val()==d(this).attr("placeholder")&&d(this).val("")}function c(){d(this).val()||d(this).val(d(this).attr("placeholder"))}a.val(a.attr("placeholder")),a.on("focus",b),a.on("blur",c)},c.cookie={prefix:"exitintel_",set:function(a,b,d){var e=c.cookie.prefix+a,f="";if(d){var g=new Date;g.setTime(g.getTime()+24*d*60*60*1e3),f="; expires="+g.toGMTString()}var h=window.location.host;if(!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)){var i=window.location.host.match(/([^.]+\.[^\.]+)$/);i&&(h="."+i[0])}"cookie-domain"==c.config.storageEngine?(document.cookie=e+"="+b+f+";domain="+h+";path=/;",c.cookie.get(a)!=b&&(c.cookie.nuke(a),document.cookie=e+"="+b+f+";domain="+h+";path=/;")):document.cookie=e+"="+b+f+";path=/;"},get:function(a){a=c.cookie.prefix+a;for(var b=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return f.substring(b.length,f.length)}return null},unset:function(a){c.cookie.set(a,"",-10)},nuke:function(a){a=c.cookie.prefix+a,document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;"},getJSON:function(a,b){var d,e=c.cookie.get(a);try{d=JSON.parse(e)}catch(f){d=null}return!d&&b?b:d},setJSON:function(a,b,d){var e=JSON.stringify(b);c.cookie.set(a,e,d)},resetAll:function(){var a=document.cookie.split(";").map(function(a){var b=a.split("=");return{name:b[0].trim(),value:b[1]}}),b=a.filter(function(a){return a.name.match(/^exitintel_/)?!0:!1}),d=window.location.host;if(!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)){var e=window.location.host.match(/([^.]+\.[^\.]+)$/);e&&(d="."+e[0])}for(var f=0;f<b.length;f++){var g=b[f].name.replace(/^exitintel_/,""),h=c.cookie.get(g);if(null!==h&&"ver"!=g){document.cookie=c.cookie.prefix+g+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;",document.cookie=c.cookie.prefix+g+"=;domain="+d+";expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;";var i=["ref","sid","lp"].indexOf(g)>=0?null:c.config.cookieExpirationDays;c.cookie.set(g,h,i)}}}},c.visitor={identity:{_initialized:!1,id:null,campaigns:{seen:[],converted:[],disabled:[],visited:[]},profile:{gatheredData:{},achivedGoals:{}}},session:{id:null,originalReferrer:null,landingPage:null,isFirstVisit:!1,pageviewCount:0},init:function(){if("undefined"!=typeof eiSession&&eiSession.hasOwnProperty("identity")&&eiSession.hasOwnProperty("session"))return void this.initWithSession();var a=c.cookie.get("vid");a||(a=c.util.getUniqueId(),c.cookie.set("vid",a,c.config.cookieExpirationDays)),this.identity.id=a,this.session.id=c.cookie.get("sid"),this.session.id||(this.session.id=c.util.getUniqueId(),this.session.isFirstVisit=!0,c.cookie.set("sid",this.session.id)),this.session.originalReferrer=c.cookie.get("ref"),this.session.originalReferrer||(this.session.originalReferrer=document.referrer,c.cookie.set("ref",this.session.originalReferrer)),this.session.pageviewCount=c.cookie.get("pvc"),this.session.pageviewCount?this.session.pageviewCount++:this.session.pageviewCount=1,c.cookie.set("pvc",this.session.pageviewCount),this.session.landingPage=c.cookie.get("lp"),this.session.landingPage||(this.session.landingPage=document.URL,c.cookie.set("lp",this.session.landingPage));var b=c.cookie.getJSON("prf");null===b?c.cookie.setJSON("prf",this.identity.profile,c.config.cookieExpirationDays):c.visitor.identity.profile=b,this.loadCampaignInfo(),this.filterExpiredCampaignInfo(),this.saveCampaignInfo(),this.identity._initialized=!0},initWithSession:function(){this.identity=eiSession.identity,this.session=eiSession.session,this.saveCampaignInfo()},getAssignedConfiguration:function(){var a=c.cookie.get("cfid");return a?a:null},assignConfiguration:function(a){c.cookie.set("cfid",a,c.config.cookieExpirationDays)},chooseConfiguration:function(a){for(var b=a.map(function(a){return parseInt(a.bias,10)}),d=Math.round(100*Math.random()),e=0,f=0;f<b.length;f++)if(e+=b[f],0!==b[f]&&e>=d){var g=a[f];return c.visitor.assignConfiguration(g.id),g.id}return"default"},getIdentity:function(){return this.identity._initialized||this.init(),this.identity},loadCampaignInfo:function(){var a={seen:"cs",converted:"cc",disabled:"cd",visited:"cv"};for(var b in a)if("function"!=typeof a[b]){var d=c.cookie.getJSON(a[b]);"string"==typeof d&&d.length>1&&(d=null,c.util.warn("Corrupted: "+b)),d||(d=[]),this.identity.campaigns[b]=d}},saveCampaignInfo:function(){var a={seen:"cs",converted:"cc",disabled:"cd",visited:"cv"};for(var b in a)"function"!=typeof a[b]&&c.cookie.setJSON(a[b],this.identity.campaigns[b],c.config.cookieExpirationDays)},filterExpiredCampaignInfo:function(){for(var a in this.identity.campaigns)if("function"!=typeof this.identity.campaigns[a]){for(var b=this.identity.campaigns[a],c=[],d=0;d<b.length;d++){var e=b[d];(!e.expires||e.expires>Math.floor((new Date).getTime()/1e3))&&c.push(e)}this.identity.campaigns[a]=c}},getViewportSize:function(){var a=Math.max(document.documentElement.clientWidth,window.innerWidth||0),b="xs";a>=768&&992>a?b="sm":a>=992&&1200>a?b="md":a>=1200&&(b="lg");var c={width:a,height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)};return c["class"]=b,c},_setCampaignStatus:function(a,b,c,d){c||(c=null),d||(d={});var e=!1;this.identity.campaigns[a]||(this.identity.campaigns[a]=[]);for(var f=0;f<this.identity.campaigns[a].length;f++){var g=this.identity.campaigns[a][f];g.id==b&&(g.expires=c,g.timestamp=Math.floor((new Date).getTime()/1e3),g.params=d,g.count++,e=!0)}if(!e){var h={id:b,expires:c,timestamp:Math.floor((new Date).getTime()/1e3),params:d,count:1};this.identity.campaigns[a].push(h)}this.saveCampaignInfo()},_unsetCampaignStatus:function(a,b){for(var c=this.identity.campaigns[a],d=[],e=0;e<c.length;e++)c[e].id!=b&&d.push(c[e]);this.identity.campaigns[c]=d,this.saveCampaignInfo()},setSeenCampaign:function(a,b){var d=c.campaign.get(a),e=null;d&&d.seenExpiration&&(e=c.util.getDayOffset(d.seenExpiration)),this._setCampaignStatus("seen",a,e,b)},setConvertedCampaign:function(a,b){var d=c.campaign.get(a),e=null;d&&d.convertedExpiration&&(e=c.util.getDayOffset(d.convertedExpiration)),this._setCampaignStatus("converted",a,e,b)},setDisabledCampaign:function(a,b,d){var e=c.campaign.get(a),f=null;e&&e.disabledExpiration&&(f=c.util.getDayOffset(e.disabledExpiration)),e&&d&&(f=c.util.getDayOffset(5475)),this._setCampaignStatus("disabled",a,f,b)},unsetSeenCampaign:function(a){this._unsetCampaignStatus("seen",a)},unsetConvertedCampaign:function(a){this._unsetCampaignStatus("converted",a)},unsetDisabledCampaign:function(a){this._unsetCampaignStatus("disabled",a)},hasSeenCampaign:function(a){for(var b=c.visitor.identity.campaigns.seen,d=0;d<b.length;d++)if(b[d].id==a)return!0;return!1},hasSeenCampaigns:function(a){for(var b=0;b<a.length;b++){var d=a[b],e=c.visitor.getSeenCampaign(d.campaignId);if(!e)return!1;if(!c.util.campaignCookieWithinTimeOffset(e,d.offsetFrom,d.offsetTo))return!1}return!0},getSeenCampaign:function(a){var b=c.visitor.identity.campaigns.seen;if(!b)return!1;for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d];return!1},hasConvertedCampaign:function(a){var b=c.visitor.identity.campaigns.converted;if(!b)return!1;for(var d=0;d<b.length;d++)if(b[d].id==a)return!0;return!1},hasConvertedCampaigns:function(a){for(var b=0;b<a.length;b++){var d=a[b],e=c.visitor.getConvertedCampaign(d.campaignId);if(!e)return!1;if(!c.util.campaignCookieWithinTimeOffset(e,d.offsetFrom,d.offsetTo))return!1}return!0},getConvertedCampaign:function(a){var b=c.visitor.identity.campaigns.converted;if(!b)return!1;for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d];return!1},getDisabledCampaign:function(a){var b=c.visitor.identity.campaigns.disabled;if(!b)return!1;for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d];return!1},hasVisitedCampaign:function(a){return c.visitor.identity.campaigns.visited.indexOf(a)>-1?!0:!1},setVisitedCampaign:function(a){-1==c.visitor.identity.campaigns.visited.indexOf(a)&&c.visitor.identity.campaigns.visited.push(a),this.saveCampaignInfo()},setGatheredData:function(a){c.visitor.identity.profile.gatheredData[a]={timestamp:Math.floor((new Date).getTime()/1e3)},c.visitor.saveProfileData()},setAchivedGoal:function(a){c.visitor.identity.profile.achivedGoals[a]={timestamp:Math.floor((new Date).getTime()/1e3)},c.visitor.saveProfileData()},hasGatheredData:function(a){var b=null;try{b=c.visitor.identity.profile.gatheredData[a]}catch(d){return!1}return b?!0:!1},hasAchivedGoal:function(a){var b=null;try{b=c.visitor.identity.profile.achivedGoals[a]}catch(d){return!1}return b?!0:!1},saveProfileData:function(){c.cookie.setJSON("prf",c.visitor.identity.profile,c.config.cookieExpirationDays)}},c.campaign={available:[],active:[],dependencies:[],init:function(){this.loadFromUrl()},campaignsLoaded:function(){if(c.config.disabled)return void c.event.log("pageview");c.campaign.chooseAds(),c.campaign.chooseActive();for(var a=!1,b=0;b<c.campaign.active.length;b++){var d=c.campaign.active[b];if(d.selectedAd){var e={};d.displayLimitPerPage&&(e.displayLimitPerPage=d.displayLimitPerPage);var f=c.util.detectDevice.isMobile,g="desktop";if(f.phone?g="phone":f.tablet&&(g="tablet"),d.selectedAd.selectedVersion&&d.selectedAd.selectedVersion.trigger&&d.selectedAd.selectedVersion.trigger[g]&&"on-load"==d.selectedAd.selectedVersion.trigger[g].type){if(a)continue;a=!0}e.priority=d.priority,c.ad.install(d.selectedAd,e)}c.event.log("pageview",{campaignId:d.id,adId:d.selectedAd?d.selectedAd.id:null})}var h=null,i=null;c.campaign.active.length&&(h=c.campaign.active[0],c.campaign.active[0].selectedAd&&(i=c.campaign.active[0].selectedAd)),c.event.log("pageview")},loadFromUrl:function(){if(c.visitor.getIdentity(),c.config.prefetchedConfiguration)setTimeout(function(){c.campaign.campaignsFileLoaded(c.config.prefetchedConfiguration)});else{var a=c.util.getPublicationId();c.api.getCampaigns(c.config.clientId,a)}},applyConfiguration:function(a){switch(a){case"control":c.campaign.available=[];break;case"default":break;default:var b=c.config.configurations.filter(function(b){return b.id==a?!0:!1});if(b&&1==b.length){var d=b[0].campaigns;c.campaign.available=c.campaign.available.filter(function(a){return d.indexOf(a._id)>-1?!0:!1})}}},campaignsFileLoaded:function(a){c.campaign.available=a.campaigns,c.config.whitelabel=a.whitelabel,c.config.brandingType=a.brandingType||"standard",c.config.primaryBrandColor=a.primaryBrandColor,c.config.configurations=a.configurations||[],c.config.audiences=a.audiences||[];var b="default";if(c.config.configurations.length){b=c.visitor.getAssignedConfiguration();var d=c.config.configurations.filter(function(a){return 0!==parseInt(a.bias,10)?!0:!1}),e=d.map(function(a){return a.id});b&&-1!=e.indexOf(b)||(b=c.visitor.chooseConfiguration(c.config.configurations))}else c.visitor.assignConfiguration("default");c.campaign.applyConfiguration(b);var f=new c.util.jQuery.Deferred,g=new c.util.jQuery.Deferred;c.campaign.loadModuleDependancies(g),g.then(function(){if(a.onloadJS){-1==a.onloadJS.indexOf("deferred.resolve()")&&(a.onloadJS+=";deferred.resolve();"),-1==a.onloadJS.indexOf("return deferred.promise();")&&(a.onloadJS+=";return deferred.promise();");var b=new Function("deferred",a.onloadJS);b(f)}else f.resolve();f.then(function(){c.campaign.campaignsLoaded()})})},loadModuleDependancies:function(a){for(var b={geolocation:!1},d=0;d<c.campaign.available.length;d++){var e=c.campaign.available[d];e.rules.filter(function(a){return"geo-location"==a.filter}).length&&(b.geolocation=!0)}return b.geolocation?sessionStorage.getItem("exitintel_geo")?a.resolve():c.util.jQuery.getJSON("https://j576j5dsib.execute-api.us-east-1.amazonaws.com/prod/custom/common/geolocate?callback=?",function(b){sessionStorage.setItem("exitintel_geo",JSON.stringify(b)),a.resolve()}):a.resolve(),a.promise()},chooseActive:function(){for(var a=0;a<c.campaign.available.length;a++)this.isEligible(c.campaign.available[a])?(c.util.log("Active campaign: "+c.campaign.available[a].id),this.active.push(c.campaign.available[a])):c.util.log("Not active campaign: "+c.campaign.available[a].title);this.active.length||c.util.log("No active campaigns.")},chooseAds:function(){c.campaign.chooseAdsFromSeen(),c.campaign.forceDepenancies(),c.campaign.chooseAdsAtRandom(),c.campaign.forceDepenancies()},chooseAdsFromSeen:function(){for(var a=0;a<this.available.length;a++){var b=this.available[a];if(!b.selectedAd&&b.enabled_ads.length){var d=c.visitor.getSeenCampaign(b.id);if(d.params&&d.params.adId)for(var e=0;e<b.enabled_ads.length;e++)if(b.enabled_ads[e]._id==d.params.adId){var f=b.enabled_ads[e];f.number=e,this.chooseVersion(f),f.selectedVersion&&(this.available[a].selectedAd=f,c.util.log("Forcing ad from seen campaign "+b.id+" to "+f.title))}}}},chooseAdsAtRandom:function(){for(var a=0;a<this.available.length;a++){var b=this.available[a];if(!b.selectedAd&&(c.util.log(b.id+" has "+b.enabled_ads.length+" enabled ads."),b.enabled_ads.length)){var d=Math.floor(Math.random()*b.enabled_ads.length),e=b.enabled_ads[d];e.number=d,c.util.log(b.id+": choosing ad randomly "+e.title),this.chooseVersion(e),e.selectedVersion&&(this.available[a].selectedAd=e)}}},forceDepenancies:function(){for(var a=0;a<this.available.length;a++){var b=this.available[a].selectedAd;if(b&&"object"==typeof b.dependencies&&b.dependencies.length)for(var d=0;d<b.dependencies.length;d++){var e=b.dependencies[d];c.campaign.selectAd(e.campaignId,e.adId)}}},chooseVersion:function(a){if(!a.selectedVersion)for(var b=c.visitor.getViewportSize(),d=0,e=0;e<a.versions.length;e++){var f=a.versions[e];if(f.template&&"true"==f.ready){var g=parseInt(f.template.width,10),h=parseInt(f.template.height,10);if("Persistent"==f.template.type&&(g=parseInt(f.template.persistentInnerCanvasPosition.width,10),h=parseInt(f.template.persistentInnerCanvasPosition.height,10)),"manual"==f.mediaTargetMode){if(-1==f.mediaTargets.indexOf(b["class"]))continue}else if(g>b.width+20)continue;var i=g*h;if(!(d>i)){d=i,a.selectedVersion=f;var j=c.ad.getVersionDependencies(f);j.length&&(a.dependencies=j)}}}},selectAd:function(a,b){for(var d=0;d<this.available.length;d++){var e=this.available[d];if(e.id==a)for(var f=0;f<e.enabled_ads.length;f++){var g=e.enabled_ads[f];g.id==b&&(c.util.log("force selecting (dependency): "+g.title),this.chooseVersion(g),g.selectedVersion&&(this.available[d].selectedAd=g))}}},isEligible:function(a){try{if(c.debug.preview.isPreviewSession)return!0}catch(b){}if(a.displayLimit){var d=c.visitor.getSeenCampaign(a.id);if(d&&d.count>=a.displayLimit)return!1}if(a.maximumConversions){var e=c.visitor.getConvertedCampaign(a.id);if(e&&e.count>=a.maximumConversions)return!1}var f=c.visitor.getDisabledCampaign(a.id);if(f)return!1;for(var g=0;g<a.rules.length;g++){var h=a.rules[g];if(("disable"==h.mode||"disable-forever"===h.mode)&&this.testRule(h,a))return c.visitor.setDisabledCampaign(a.id,null,"disable-forever"===h.mode),!1}for(var i=0;i<a.rules.length;i++){var j=a.rules[i];if("show"==j.mode&&!this.testRule(j,a))return!1;if("hide"==j.mode&&this.testRule(j,a))return!1}return!0},testRule:function(a,b){switch(a.filter){case"url":return this.testURLRule("pageURL",a);case"referer-url":return this.testURLRule("referrerURL",a);case"landing-page-url":return this.testURLRule("landingPageURL",a);case"prerequisite-campaign":return c.visitor.hasSeenCampaigns(a.prerequisiteCampaign);case"prerequisite-negative-campaign":return!c.visitor.hasSeenCampaigns(a.prerequisiteCampaign);case"prerequisite-converted-campaign":return c.visitor.hasConvertedCampaigns(a.prerequisiteCampaign);case"prerequisite-negative-converted-campaign":return!c.visitor.hasConvertedCampaigns(a.prerequisiteCampaign);case"pageview-count-more-than":return c.visitor.session.pageviewCount>parseInt(a.value,10);case"gathered-email":return c.visitor.hasGatheredData("email");case"device-type":try{var d=a.value.split(","),e="desktop";return c.util.detectDevice.isMobile.phone&&(e="phone"),c.util.detectDevice.isMobile.tablet&&(e="tablet"),-1!==d.indexOf(e)?!0:!1}catch(f){return c.util.error(f),!1}break;case"geo-location":var g=null;try{g=JSON.parse(sessionStorage.getItem("exitintel_geo"))}catch(f){g=null}if(!g)return!1;if(a.value){if(a.value.country&&""!==a.value.country&&a.value.country!==g.countryCode)return!1;if(a.value.region&&""!==a.value.region&&a.value.region!==g.region)return!1;if(a.value.city&&""!==a.value.city&&a.value.city!==g.city)return!1}return!0;case"mobile-seo-filter":for(var h=[c.util.detectDevice.isMobile.any,c.cookie.get("ref").match(/google/),c.visitor.session.pageviewCount<2],i=0;i<h.length;i++)if(!h[i])return!1;return!0;case"custom-code":try{var j=new Function("thisCampaign","try { "+a.value+"} catch (e) { exitintel.util.error(e); }");return j(b)}catch(f){return c.util.error(f),!1}}},testURLRule:function(a,b){var d=!1;switch(b.filterType){case"not-contains":d=!0;case"contains":if(c.util[a+"Contains"](b.value))return!d;break;case"not-exact-match":d=!0;case"exact-match":if(c.util[a+"Is"](b.value))return!d}return d},get:function(a){for(var b=0;b<c.campaign.available.length;b++)if(c.campaign.available[b].id==a)return c.campaign.available[b];return null}},c.ecommerce={handleEvent:function(a){c.event.log(a[1],{data:a[2]})}},c.trigger={installedTriggers:{},postponedTriggers:[],pendingActions:[],install:function(a,b,d){if("undefined"==typeof c.triggerTypes[a])return void c.util.log("Trigger type '"+a+"' is not supported.");var e=c.triggerTypes[a].install,f=c.util.getUniqueId();if("true"==d.postpone){var g=parseInt(d.postponeBy,10);c.util.log("Postponing trigger installation for "+g+" seconds.");var h=setTimeout(function(){e(f,b,d)},1e3*g);c.trigger.postponedTriggers.push(h)}else e(f,b,d);return c.trigger.installedTriggers[f]={type:a},f},uninstall:function(a){if("undefined"==typeof c.trigger.installedTriggers[a])return void c.util.log("Unable to uninstall trigger: "+a+". Not found.");if(null===c.trigger.installedTriggers[a])return void c.util.log("Trigger: "+a+" is already uninstalled");var b=c.trigger.installedTriggers[a],d=c.triggerTypes[b.type].uninstall;d(a)&&(c.trigger.installedTriggers[a]=null)},uninstallAll:function(){for(var a in this.installedTriggers)"function"!=typeof this.installedTriggers[a]&&this.uninstall(a);for(var b=0;b<this.postponedTriggers.length;b++)clearTimeout(this.postponedTriggers[b])}},c.triggerTypes={onLoad:{install:function(a,b,c){var d=1e3*c.delay||0;setTimeout(b,d)},uninstall:function(){return!0}},onExit:{install:function(a,b,e){var f="mouseleave."+a+".exitintel",g=1e3*e.delay||0,h=null,i=null,j=!0;return d("html").on(f,function(a){var e=a.pageY-d(window).scrollTop();j=!1;var f=[];2>=e&&(i=c.util.jQuery.Deferred(),clearTimeout(h),f.push(c.activityWatch.onInactive()),f.push(i.promise()),h=setTimeout(function(){i.resolve()},g),d.when.apply(d,f).then(function(){j||b()}))}),d("html").on("mouseenter."+a+".exitintel",function(){j=!0,clearTimeout(h),null!==i&&i.reject()}),d("html").on("keydown."+a+".exitintel",function(a){a.metaKey&&76===a.keyCode&&(g?setTimeout(b,g):b())}),!0},uninstall:function(a){var b="mouseleave."+a+".exitintel";return d("html").off(b),b="keydown."+a+".exitintel",d("html").off(b),b="mouseenter."+a+".exitintel",d("html").off(b),!0}},onScrollTimeout:{install:function(a,b,e){var f=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(","),g=1e3*e.delay||0,h=null,i=null;return d(window).on(f,function(){clearTimeout(h),i=c.util.jQuery.Deferred();var e=[];e.push(c.activityWatch.onInactive()),e.push(i.promise()),h=setTimeout(function(){i.resolve()},g),d.when.apply(d,e).then(function(){c.activityWatch.userActive()||null!==c.trigger.installedTriggers[a]&&b()})}),!0},uninstall:function(a){var b=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(",");return d(window).off(b),!0}},onScrolledToBottom:{install:function(a,b,c){var e=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(","),f=1e3*c.delay||0;d(window).on(e,function(){var a=d(document).height(),c=d(window).height()+d(window).scrollTop();(a-c)/a===0&&setTimeout(function(){b()},f)})},uninstall:function(a){var b=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(",");d(window).off(b)}},onScrolledToElement:{install:function(a,b,c){var e=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(","),f=1e3*c.delay||0,g=d(c.selector),h=null;switch(c.targetMode){case"reached-top":h=g.position().top;break;case"reached-bottom":h=g.position().top+g.height()}g.length&&d(window).on(e,function(){var a=d(window).height()+d(window).scrollTop();0>=(h-a)/h&&setTimeout(function(){b()},f)})},uninstall:function(a){var b=["scroll."+a+".exitintel","touchmove."+a+".exitintel"].join(",");d(window).off(b)}}},c.activityWatch={timers:{keyboard:null,mousehover:null,mouseclick:null},watches:{keyboard:!1,mousehover:!1,mouseclick:!1},init:function(){var a=function(){c.activityWatch.watches.keyboard=!0,clearTimeout(c.activityWatch.timers.keyboard),c.activityWatch.timers.keyboard=setTimeout(function(){c.activityWatch.watches.keyboard=!1},1e4)};d("body").on("keyup",a),d("body").on("focusin focusout","input",a),d("body").on("mouseover","a,button",function(){c.activityWatch.watches.mousehover=!0,clearTimeout(c.activityWatch.timers.mousehover),c.activityWatch.timers.mousehover=setTimeout(function(){c.activityWatch.watches.mousehover=!1},150)}),d("body").on("click","a,button",function(){c.activityWatch.watches.mouseclick=!0,clearTimeout(c.activityWatch.timers.mouseclick),c.activityWatch.timers.mouseclick=setTimeout(function(){c.activityWatch.watches.mouseclick=!1},3e3)})},onInactive:function(){var a=new c.util.jQuery.Deferred;return(this.watches.keyboard||this.watches.mousehover||this.watches.mouseclick)===!1?a.resolve():this.waitForInactive(a),a.promise()},waitForInactive:function(a){this.userActive()?setTimeout(function(){c.activityWatch.waitForInactive(a)},100):a.resolve()},userActive:function(){return this.watches.keyboard||this.watches.mousehover||this.watches.mouseclick}},c.event={logServiceURL:"//app.exitintel.com/log/ei.gif?",queueProcessingTimeout:null,queue:[],log:function(a,b){if(b&&b.onDone){var c=this.serializeEvent({type:a,args:b});return void this.sendEvents([c],b.onDone)}this.queue.push({type:a,args:b}),clearTimeout(this.queueProcessingTimeout),this.queueProcessingTimeout=setTimeout(this.processQueue,1e3)},processQueue:function(){if(c.event.queue.length){for(var a=[],b=0;b<c.event.queue.length;b++){var d=c.event.queue[b];a.push(c.event.serializeEvent(d))}c.event.sendEvents(a),c.event.queue=[]}},serializeEvent:function(a){var b={};switch(a.args&&(a.args.campaignId&&(b.cId=a.args.campaignId,b.stId=a.args.campaignId+"-st"),a.args.adId&&(b.adId=a.args.adId),a.args.data&&(b.data=JSON.stringify(a.args.data))),a.type){case"pageview":b.et="p",!c.visitor.session.isFirstVisit||a.args&&a.args.campaignId?a.args&&a.args.campaignId&&!c.visitor.hasVisitedCampaign(a.args.campaignId)&&(b.et+=",v"):(b.et+=",v",c.visitor.session.isFirstVisit=!1),a.args&&a.args.campaignId&&!c.visitor.hasVisitedCampaign(a.args.campaignId)&&c.visitor.setVisitedCampaign(a.args.campaignId);break;case"ad-impression":b.et="i";break;case"collect-data":b.et="c";break;case"trackItemView":b.et="ev";break;case"trackCartUpdate":b.et="ec";break;case"trackAddItem":b.et="ea";break;case"trackOrder":b.et="eo";break;case"goal-completed":b.et="g";break;case"custom":b.et="c"}return b},sendEvents:function(a,b){for(var e=["aId="+encodeURIComponent(c.config.clientId),"vId="+encodeURIComponent(c.visitor.identity.id),"sId="+encodeURIComponent(c.visitor.session.id),"ref="+encodeURIComponent(c.visitor.session.originalReferrer),"cId="+encodeURIComponent(c.visitor.getAssignedConfiguration()),"url="+encodeURIComponent(window.location.href)],f=0;f<a.length;f++){var g=a[f];for(var h in g)"function"!=typeof g[h]&&("et"==h?e.push("e["+f+"][t]="+encodeURIComponent(g[h])):e.push("e["+f+"][d]["+h+"]="+encodeURIComponent(g[h])))}var i=new Image;b&&(d(i).on("load",function(){b(!0)}),i.onerror=function(){b(!0)},i.onabort=function(){b(!0)}),i.src="https://betastats.exitintel.com/?"+e.join("&")+"&_t="+(new Date).valueOf()}},c.events={events:{},on:function(a,b){"object"!=typeof this.events[a]&&(this.events[a]=[]),this.events[a].push(b)},removeListener:function(a,b){var c;"object"==typeof this.events[a]&&(c=this.events[a].indexOf(b),c>-1&&this.events[a].splice(c,1))},emit:function(a){var b,c,d,e=[].slice.call(arguments,1),f={type:a},g=e.slice(0);if(g.unshift(f),"object"==typeof this.events[a])for(c=this.events[a].slice(),d=c.length,b=0;d>b;b++)c[b].apply(this,g);if("object"==typeof this.events["*"])for(c=this.events["*"].slice(),d=c.length,b=0;d>b;b++)c[b].apply(this,g)},once:function(a,b){this.on(a,function c(){this.removeListener(a,c),b.apply(this,arguments)})}},c.shopify={cartSessionAppend:function(a){var b=document.getElementById(a);if(b){var d={identity:c.visitor.identity,session:c.visitor.session},e=document.createElement("span");e.innerHTML='<input type="hidden" name="attributes[ei-session]" value="'+encodeURIComponent(JSON.stringify(d))+'"/>',b.appendChild(e)}}},Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),c.commands={timer:null,startCheckLoop:function(){c.commands.timer&&clearTimeout(c.commands.timer),c.commands.checkQueue(),c.commands.timer=setInterval(function(){c.commands.checkQueue()},1e3)},stopCheckLoop:function(){clearTimeout(c.commands.timer)},checkQueue:function(){if("undefined"!=typeof window._exiq){if(0===window._exiq.length)return;for(var a=0;a<window._exiq.length;a++)if(Array.isArray(window._exiq[a])&&window._exiq[a].length>0){var b=window._exiq[a],d=b[0];switch(d){case"_setVar":c.visitor.session.vars=c.visitor.session.vars||{},c.visitor.session.vars[b[1]]=b[2];break;case"ecommerce":c.ecommerce.handleEvent(window._exiq[a]);break;case"disableCampaigns":c.config.disabled||(c.config.disabled=!0,c.ad.visibleAds.popup&&c.ad.visibleAds.popup.hide(),c.ad.visibleAds.persistent&&c.ad.visibleAds.persistent.hide(),c.campaign.active=[],c.ad.installedAds={},c.trigger.uninstallAll(),c.ad.adTriggers={},c.campaign.campaignsLoaded());break;case"enableCampaigns":c.config.disabled&&(c.config.disabled=!1,c.campaign.active=[],c.ad.installedAds={},c.trigger.uninstallAll(),c.ad.adTriggers={},c.campaign.campaignsLoaded())}}window._exiq=[]}}},c.profiler={connected:!1,socket:null,performance:{},connect:function(){window.performance&&window.performance.timing&&(c.profiler.performance=window.performance.timing,c.util.loadJS(c.config.profilerLibURL,function(){c.profiler.socket=io(c.config.profilerURL),c.profiler.connected=!0,c.profiler.init()}))},init:function(){var a=c.profiler.performance;c.profiler.socket.emit("meta",{"user-agent":navigator.userAgent,url:window.location.href,"visitor-id":c.visitor.identity.id,"session-id":c.visitor.session.id}),c.profiler.sendValue("window-loaded",a.loadEventEnd-a.connectStart),c.profiler.sendValue("dom-ready",a.domComplete-a.connectStart),c.profiler.send("connected")},sendValue:function(a,b){c.profiler.connected&&(console.warn("send: "+a),c.profiler.socket.emit("time",{name:a,value:b}))},send:function(a){var b=c.profiler.performance;c.profiler.sendValue(a,(new Date).valueOf()-b.connectStart)}},c.integrations=c.integrations||{},c.integrations._api={send:function(a,b,e,f,g){d.ajax({method:"POST",url:c.config.integrationsApiUrl+"/send/"+a+"/"+b+"?sync="+(g?"true":""),data:e,timeout:1e4,beforeSend:function(a,b){console.log(b.url)}}).done(function(a){"success"!==a.status?f.reject(a):f.resolve(a)}).fail(function(){f.reject({status:"error",errorId:999999,errorMessage:"General error"})})},lookup:function(a,b,e,f,g){d.ajax({method:"GET",url:c.config.integrationsApiUrl+"/lookup/"+a+"/"+b,data:{email:e,list:f},timeout:1e4}).done(function(a){"success"!==a.status?g.reject(a):g.resolve(a)}).fail(function(){g.reject({status:"error",errorId:999999,errorMessage:"General error"})})}},c.integrations=c.integrations||{},c.integrations.mailchimp={send:function(a,b,d,e){var f=c.util.jQuery.Deferred();return c.integrations._api.send("mailchimp",a,{email:b,visitor_id:c.visitor.identity.id,merge_vars:d},f,e),f.promise()},lookup:function(a,b){var d=c.util.jQuery.Deferred();return c.integrations._api.lookup("mailchimp",a,b.email,b.list,d),d.promise()}},c.integrations=c.integrations||{},c.integrations.klaviyo={send:function(a,b,d,e){var f=c.util.jQuery.Deferred();return c.integrations._api.send("klaviyo",a,{email:b,visitor_id:c.visitor.identity.id,merge_vars:d},f,e),f.promise()},lookup:function(a,b){var d=c.util.jQuery.Deferred();return c.integrations._api.lookup("klaviyo",a,b.email,b.list,d),d.promise()}},c.integrations=c.integrations||{},c.integrations.bronto={send:function(a,b,d,e){var f=c.util.jQuery.Deferred();return c.integrations._api.send("bronto",a,{email:b,visitor_id:c.visitor.identity.id,merge_vars:d},f,e),f.promise()},lookup:function(a,b){var d=c.util.jQuery.Deferred();return c.integrations._api.lookup("bronto",a,b.email,b.list,d),d.promise()}},c.integrations=c.integrations||{},c.integrations.ga={trackEvent:function(a,b,d,e){var f=!(!window._gaq||!window._gaq.push||window._gaq.push===Array.prototype.push);return f?void window._gaq.push(["_trackEvent",a,b,d,e,!0]):void("undefined"!=typeof ga&&ga(function(){for(var f=ga.getAll(),g=[],h=0;h<f.length;++h)try{var i=f[h].get("name"),j=f[h].get("trackingId");if(-1!==g.indexOf(j))continue;g.push(j),ga(i+".send","event",a,b,d,e||0,{nonInteraction:1})}catch(k){c.util.log("Unable to send to GA")}}))}},c.migration={run:function(){var a=0|parseInt(c.cookie.get("ver"),10),b=c.config.schemaVersion;if(b>a)for(var d=a;b>d;d++)c.migration._mig[d+"_to_"+(d+1)]&&c.migration._mig[d+"_to_"+(d+1)]();var e=365,f=new Date;f.setTime(f.getTime()+24*e*60*60*1e3);var g="; expires="+f.toGMTString();document.cookie="exitintel_ver="+b+g+";path=/;"},_mig:{"0_to_1":function(){c.util.log("Migrating cookies 0 to 1");for(var a=document.cookie.split(";").map(function(a){var b=a.split("=");return{name:b[0].trim(),value:b[1]}}),b=a.filter(function(a){return a.name.match(/^exitintel_/)?!0:!1}),d=0;d<b.length;d++){var e=b[d].name.replace(/^exitintel_/,""),f=c.cookie.get(e);if(null!==f){document.cookie=c.cookie.prefix+e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;";var g=["ref","sid","lp"].indexOf(e)>=0?null:c.config.cookieExpirationDays;c.cookie.set(e,f,g)}}}}},c.debug=c.debug||{},c.debug.options={},c.debug.preview={isPreviewSession:!1},c.debug.init=function(){try{var a=sessionStorage.getItem("exitintel_account_override");a&&(c.config.clientId=a)}catch(b){}c.debug.loadOptions(),c.debug.parseURLCommands(),c.debug.showNotification(),window.location.href.match(/exitintel-debug:(.*)/)&&(c.config.prefetchedConfiguration=null)},c.debug.setOption=function(a,b){c.debug.options[a]=b,c.debug.saveOptions()},c.debug.saveOptions=function(){sessionStorage.setItem("exitintel_debug_options",JSON.stringify(c.debug.options))},c.debug.loadOptions=function(){try{c.debug.options=JSON.parse(sessionStorage.getItem("exitintel_debug_options")),("object"!=typeof c.debug.options||null===c.debug.options)&&(c.debug.options={});
}catch(a){c.debug.options={}}},c.debug.parseURLCommands=function(){var a=[];if(window.location.href.match(/exitintel-debug/)){if(window.location.href.match(/exitintel-debug:(\[.*\])/)||decodeURIComponent(window.location.href).match(/exitintel-debug:(\[.*\])/))try{a=JSON.parse(RegExp.$1)}catch(b){a=JSON.parse(decodeURIComponent(RegExp.$1))}if((!a||!a.length)&&window.location.href.match(/exitintel-debug:([^#]*)/))try{a=JSON.parse(atob(RegExp.$1))}catch(b){a=null}}if(a)for(var d=0;d<a.length;d++)"pub"==a[d].name?a[d].value?(console.dir("set pub cookies"),console.dir(a[d]),c.cookie.set("publication",a[d].value,1)):c.cookie.unset("publication"):"reset"==a[d].name?c.debug.resetCookies():"set-account"==a[d].name?(c.config.clientId=a[d].value,sessionStorage.setItem("exitintel_account_override",a[d].value)):"preview"==a[d].name?(c.debug.preview.isPreviewSession=!0,c.debug.preview.campaignId=a[d].campaignId,c.debug.preview.adId=a[d].adId):"option"==a[d].name&&c.debug.setOption(a[d].value,!0)},c.debug.resetCookies=function(){for(var a=document.cookie.split(";"),b=0;b<a.length;b++){for(var c=a[b];" "==c.charAt(0);)c=c.substring(1,c.length);if(c.match(/(exitintel_[a-z]+)/i)){var d=RegExp.$1;document.cookie=d+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;";var e=window.location.host;if(!window.location.host.match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)){var f=window.location.host.match(/([^.]+\.[^\.]+)$/);f&&(e="."+f[0])}document.cookie=d+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+e+";path=/;"}}return sessionStorage.setItem("exitintel_debug_options","{}"),sessionStorage.removeItem("exitintel_account_override"),null},c.debug.showNotification=function(){if("undefined"==typeof c.debug.options["disable-notification"]||!c.debug.options["disable-notification"]){var a=c.cookie.get("publication"),b=c.debug.preview.isPreviewSession,d=null;try{d=sessionStorage.getItem("exitintel_account_override")}catch(e){}if(a||b||d){var f=c.util.jQuery("<div/>").css({position:"fixed",right:"0px",bottom:"0px","font-size":"10px","background-color":"#ffffee",border:"1px solid #ffb",padding:"5px","z-index":"100000000"});a?f.html("Publication: "+a):b&&f.html("Preview session"),d&&f.append(" - <b>Account override: "+d+"</b>");var g=c.util.jQuery("<button/>").css({"margin-left":"10px"}).html("reset");g.click(function(){window.location.href='#exitintel-debug:[{"name":"reset"}]',c.debug.resetCookies(),window.location.reload()}),f.append(g),c.util.jQuery("body").append(f),setTimeout(function(){f.css("display","none")},1e4)}}},c.report={processingTimeout:null,queue:[],exception:function(a,b){c.report.error(a.name,a.message,a.stack,b)},error:function(a,b,e,f,g){var h={};d.extend(h,{accountId:c.config.clientId,visitorId:c.visitor.getIdentity().id,sessionId:c.visitor.session.id,userAgent:navigator.userAgent,url:window.location.href},f);var i={type:"error",component:"snippet",code:a,description:b,details:e,context:h};return g?void this.send([i]):(this.queue.push(i),clearTimeout(this.processingTimeout),void(this.processingTimeout=setTimeout(this.processQueue,1e3)))},send:function(a){d.ajax({url:c.config.reportURL,method:"POST",data:JSON.stringify(a)})},processQueue:function(){c.report.queue.length&&(c.report.send(c.report.queue),c.report.queue=[])}},a.exitintelConfig&&a.exitintelConfig.clientId&&(c.config.clientId=a.exitintelConfig.clientId),c.config.clientId){var e=function(){if(!window.exitintel||window.exitintel.inited!==!0){!function(){if("undefined"!=typeof Prototype&&parseFloat(Prototype.Version.substr(0,3))<1.7&&"undefined"!=typeof Array.prototype.toJSON){var a=JSON.stringify;JSON.stringify=function(b){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;var d=a(b);return Array.prototype.toJSON=c,d}}}(),c.inited=!0,c.debug.init(),c.migration.run();var a=c.cookie.getJSON("cfg")||{},b="cookie-domain";try{a&&a.storageEngine&&(b=a.storageEngine)}catch(d){}c.config.storageEngine!=b&&c.cookie.resetAll(),a.storageEngine=c.config.storageEngine,c.cookie.setJSON("cfg",a,c.config.cookieExpirationDays),c.commands.startCheckLoop(),c.campaign.init(),c.activityWatch.init(),c.config.profilerEnabled&&c.profiler.connect()}};if(window.exitintelConfig&&window.exitintelConfig.loadEvent)switch(window.exitintelConfig.loadEvent){case"load":"complete"==document.readyState?e():window.addEventListener?window.addEventListener("load",function f(){window.removeEventListener("load",f,!1),e()},!1):window.attachEvent("onload",function(){e()});break;case"none":e();break;case"ready":d(document).ready(e);break;default:d(document).ready(e)}else d(document).ready(e)}})}catch(d){c.report.exception(d)}a.exitintel=c}(this);}
	window.exitintelLoaded = true;
